<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 H2O | ANN in R</title>
  <meta name="description" content="This is a book for ANN in R examples The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 H2O | ANN in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book for ANN in R examples The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 H2O | ANN in R" />
  
  <meta name="twitter:description" content="This is a book for ANN in R examples The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Dr Sebnem Er" />


<meta name="date" content="2021-05-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="neuralnet.html"/>
<link rel="next" href="keras.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ANN Tutorial in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="neuralnet.html"><a href="neuralnet.html"><i class="fa fa-check"></i><b>2</b> Neuralnet Package</a><ul>
<li class="chapter" data-level="2.1" data-path="neuralnet.html"><a href="neuralnet.html#example-1---boston"><i class="fa fa-check"></i><b>2.1</b> Example 1 - Boston</a><ul>
<li class="chapter" data-level="2.1.1" data-path="neuralnet.html"><a href="neuralnet.html#scale-training-and-test-datasets"><i class="fa fa-check"></i><b>2.1.1</b> Scale, Training and Test Datasets</a></li>
<li class="chapter" data-level="2.1.2" data-path="neuralnet.html"><a href="neuralnet.html#build-model"><i class="fa fa-check"></i><b>2.1.2</b> Build model</a></li>
<li class="chapter" data-level="2.1.3" data-path="neuralnet.html"><a href="neuralnet.html#get-the-predictions-train-set"><i class="fa fa-check"></i><b>2.1.3</b> Get the predictions train set</a></li>
<li class="chapter" data-level="2.1.4" data-path="neuralnet.html"><a href="neuralnet.html#get-the-predictions-test-set"><i class="fa fa-check"></i><b>2.1.4</b> Get the predictions test set</a></li>
<li class="chapter" data-level="2.1.5" data-path="neuralnet.html"><a href="neuralnet.html#forward-propagation"><i class="fa fa-check"></i><b>2.1.5</b> Forward propagation</a></li>
<li class="chapter" data-level="2.1.6" data-path="neuralnet.html"><a href="neuralnet.html#model-tuning"><i class="fa fa-check"></i><b>2.1.6</b> Model Tuning</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="neuralnet.html"><a href="neuralnet.html#example-2---iris-dataset"><i class="fa fa-check"></i><b>2.2</b> Example 2 - Iris Dataset</a><ul>
<li class="chapter" data-level="2.2.1" data-path="neuralnet.html"><a href="neuralnet.html#model-tuning-1"><i class="fa fa-check"></i><b>2.2.1</b> Model Tuning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="h2o.html"><a href="h2o.html"><i class="fa fa-check"></i><b>3</b> H2O</a><ul>
<li class="chapter" data-level="3.1" data-path="h2o.html"><a href="h2o.html#initialise-h2o-connection"><i class="fa fa-check"></i><b>3.1</b> Initialise H2O Connection</a></li>
<li class="chapter" data-level="3.2" data-path="h2o.html"><a href="h2o.html#data-in-h2o-format"><i class="fa fa-check"></i><b>3.2</b> Data in H2o format</a><ul>
<li class="chapter" data-level="3.2.1" data-path="h2o.html"><a href="h2o.html#grid-search-for-complexity"><i class="fa fa-check"></i><b>3.2.1</b> Grid Search for Complexity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="keras.html"><a href="keras.html"><i class="fa fa-check"></i><b>4</b> Keras</a><ul>
<li class="chapter" data-level="4.1" data-path="keras.html"><a href="keras.html#installing-and-calling-the-keras-package"><i class="fa fa-check"></i><b>4.1</b> Installing and Calling the Keras Package</a></li>
<li class="chapter" data-level="4.2" data-path="keras.html"><a href="keras.html#keras-for-regression-problems"><i class="fa fa-check"></i><b>4.2</b> Keras for Regression Problems</a><ul>
<li class="chapter" data-level="4.2.1" data-path="keras.html"><a href="keras.html#load-the-dataset-standardize"><i class="fa fa-check"></i><b>4.2.1</b> Load the dataset, standardize</a></li>
<li class="chapter" data-level="4.2.2" data-path="keras.html"><a href="keras.html#initialize-a-sequential-feed-forward-neural-network"><i class="fa fa-check"></i><b>4.2.2</b> Initialize a sequential feed forward neural network</a></li>
<li class="chapter" data-level="4.2.3" data-path="keras.html"><a href="keras.html#define-the-structure-of-your-model-layers-and-the-activation-functions"><i class="fa fa-check"></i><b>4.2.3</b> Define the structure of your model: layers and the activation functions</a></li>
<li class="chapter" data-level="4.2.4" data-path="keras.html"><a href="keras.html#define-how-these-weights-will-be-optimized"><i class="fa fa-check"></i><b>4.2.4</b> Define how these weights will be optimized</a></li>
<li class="chapter" data-level="4.2.5" data-path="keras.html"><a href="keras.html#run-the-model-without-validation"><i class="fa fa-check"></i><b>4.2.5</b> Run the model without validation</a></li>
<li class="chapter" data-level="4.2.6" data-path="keras.html"><a href="keras.html#run-the-model-with-validation"><i class="fa fa-check"></i><b>4.2.6</b> Run the model with validation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="keras.html"><a href="keras.html#keras-for-classification-problems"><i class="fa fa-check"></i><b>4.3</b> Keras for Classification Problems</a><ul>
<li class="chapter" data-level="4.3.1" data-path="keras.html"><a href="keras.html#initialize-and-define-a-sequential-feed-forward-neural-network"><i class="fa fa-check"></i><b>4.3.1</b> Initialize and define a sequential feed forward neural network</a></li>
<li class="chapter" data-level="4.3.2" data-path="keras.html"><a href="keras.html#run-the-model-without-validation-1"><i class="fa fa-check"></i><b>4.3.2</b> Run the model without validation</a></li>
<li class="chapter" data-level="4.3.3" data-path="keras.html"><a href="keras.html#run-the-model-with-validation-1"><i class="fa fa-check"></i><b>4.3.3</b> Run the model with validation</a></li>
<li class="chapter" data-level="4.3.4" data-path="keras.html"><a href="keras.html#evaluate-the-model"><i class="fa fa-check"></i><b>4.3.4</b> Evaluate the model</a></li>
<li class="chapter" data-level="4.3.5" data-path="keras.html"><a href="keras.html#obtain-the-predictions"><i class="fa fa-check"></i><b>4.3.5</b> Obtain the predictions:</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="keras.html"><a href="keras.html#overfitting"><i class="fa fa-check"></i><b>4.4</b> Overfitting</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ANN in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="h2o" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> H2O</h1>
<p>H2O is probably the easiest to learn and use.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="h2o.html#cb80-1"></a><span class="co">## Load all packages first</span></span>
<span id="cb80-2"><a href="h2o.html#cb80-2"></a><span class="kw">library</span>(h2o)</span></code></pre></div>
<pre><code>## Warning: package &#39;h2o&#39; was built under R version 4.0.5</code></pre>
<pre><code>## 
## ----------------------------------------------------------------------
## 
## Your next step is to start H2O:
##     &gt; h2o.init()
## 
## For H2O package documentation, ask for help:
##     &gt; ??h2o
## 
## After starting H2O, you can use the Web UI at http://localhost:54321
## For more information visit https://docs.h2o.ai
## 
## ----------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;h2o&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     cor, sd, var</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     %*%, %in%, &amp;&amp;, ||, apply, as.factor, as.numeric, colnames,
##     colnames&lt;-, ifelse, is.character, is.factor, is.numeric, log,
##     log10, log1p, log2, round, signif, trunc</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="h2o.html#cb86-1"></a><span class="kw">library</span>(caret)</span>
<span id="cb86-2"><a href="h2o.html#cb86-2"></a><span class="kw">library</span>(mlbench)</span>
<span id="cb86-3"><a href="h2o.html#cb86-3"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb86-4"><a href="h2o.html#cb86-4"></a><span class="kw">library</span>(reshape2)</span>
<span id="cb86-5"><a href="h2o.html#cb86-5"></a><span class="kw">library</span>(DEEPR)</span></code></pre></div>
<pre><code>## Warning: package &#39;DEEPR&#39; was built under R version 4.0.3</code></pre>
<pre><code>## Loading required package: dirmult</code></pre>
<pre><code>## Warning: package &#39;dirmult&#39; was built under R version 4.0.3</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="h2o.html#cb90-1"></a><span class="co"># http://blog.revolutionanalytics.com/2014/04/a-dive-into-h2o.html</span></span>
<span id="cb90-2"><a href="h2o.html#cb90-2"></a><span class="co"># https://discuss.analyticsvidhya.com/t/script-in-h2o-in-r-to-get-you-into-top-30-percentile-for-the-digit-recognizer-competition/6651/8</span></span></code></pre></div>
<div id="initialise-h2o-connection" class="section level2">
<h2><span class="header-section-number">3.1</span> Initialise H2O Connection</h2>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="h2o.html#cb91-1"></a><span class="co">## Start a local H2O cluster directly from R</span></span>
<span id="cb91-2"><a href="h2o.html#cb91-2"></a>localH2O =<span class="st"> </span><span class="kw">h2o.init</span>(<span class="dt">ip =</span> <span class="st">&quot;localhost&quot;</span>, <span class="dt">port =</span> <span class="dv">54321</span>, <span class="dt">startH2O =</span> <span class="ot">TRUE</span>,<span class="dt">min_mem_size =</span> <span class="st">&quot;3g&quot;</span>)</span></code></pre></div>
<pre><code>##  Connection successful!
## 
## R is connected to the H2O cluster: 
##     H2O cluster uptime:         55 minutes 35 seconds 
##     H2O cluster timezone:       Africa/Johannesburg 
##     H2O data parsing timezone:  UTC 
##     H2O cluster version:        3.32.0.1 
##     H2O cluster version age:    7 months and 11 days !!! 
##     H2O cluster name:           H2O_started_from_R_01438475_sup231 
##     H2O cluster total nodes:    1 
##     H2O cluster total memory:   3.90 GB 
##     H2O cluster total cores:    4 
##     H2O cluster allowed cores:  4 
##     H2O cluster healthy:        TRUE 
##     H2O Connection ip:          localhost 
##     H2O Connection port:        54321 
##     H2O Connection proxy:       NA 
##     H2O Internal Security:      FALSE 
##     H2O API Extensions:         Amazon S3, Algos, AutoML, Core V3, TargetEncoder, Core V4 
##     R Version:                  R version 4.0.1 (2020-06-06)</code></pre>
<pre><code>## Warning in h2o.clusterInfo(): 
## Your H2O cluster version is too old (7 months and 11 days)!
## Please download and install the latest version from http://h2o.ai/download/</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="h2o.html#cb94-1"></a><span class="co">#Get help</span></span>
<span id="cb94-2"><a href="h2o.html#cb94-2"></a>?h2o.deeplearning</span></code></pre></div>
<pre><code>## starting httpd help server ... done</code></pre>
</div>
<div id="data-in-h2o-format" class="section level2">
<h2><span class="header-section-number">3.2</span> Data in H2o format</h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="h2o.html#cb96-1"></a><span class="co"># iris data ####</span></span>
<span id="cb96-2"><a href="h2o.html#cb96-2"></a>iris</span></code></pre></div>
<pre><code>##     Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
## 1            5.1         3.5          1.4         0.2     setosa
## 2            4.9         3.0          1.4         0.2     setosa
## 3            4.7         3.2          1.3         0.2     setosa
## 4            4.6         3.1          1.5         0.2     setosa
## 5            5.0         3.6          1.4         0.2     setosa
## 6            5.4         3.9          1.7         0.4     setosa
## 7            4.6         3.4          1.4         0.3     setosa
## 8            5.0         3.4          1.5         0.2     setosa
## 9            4.4         2.9          1.4         0.2     setosa
## 10           4.9         3.1          1.5         0.1     setosa
## 11           5.4         3.7          1.5         0.2     setosa
## 12           4.8         3.4          1.6         0.2     setosa
## 13           4.8         3.0          1.4         0.1     setosa
## 14           4.3         3.0          1.1         0.1     setosa
## 15           5.8         4.0          1.2         0.2     setosa
## 16           5.7         4.4          1.5         0.4     setosa
## 17           5.4         3.9          1.3         0.4     setosa
## 18           5.1         3.5          1.4         0.3     setosa
## 19           5.7         3.8          1.7         0.3     setosa
## 20           5.1         3.8          1.5         0.3     setosa
## 21           5.4         3.4          1.7         0.2     setosa
## 22           5.1         3.7          1.5         0.4     setosa
## 23           4.6         3.6          1.0         0.2     setosa
## 24           5.1         3.3          1.7         0.5     setosa
## 25           4.8         3.4          1.9         0.2     setosa
## 26           5.0         3.0          1.6         0.2     setosa
## 27           5.0         3.4          1.6         0.4     setosa
## 28           5.2         3.5          1.5         0.2     setosa
## 29           5.2         3.4          1.4         0.2     setosa
## 30           4.7         3.2          1.6         0.2     setosa
## 31           4.8         3.1          1.6         0.2     setosa
## 32           5.4         3.4          1.5         0.4     setosa
## 33           5.2         4.1          1.5         0.1     setosa
## 34           5.5         4.2          1.4         0.2     setosa
## 35           4.9         3.1          1.5         0.2     setosa
## 36           5.0         3.2          1.2         0.2     setosa
## 37           5.5         3.5          1.3         0.2     setosa
## 38           4.9         3.6          1.4         0.1     setosa
## 39           4.4         3.0          1.3         0.2     setosa
## 40           5.1         3.4          1.5         0.2     setosa
## 41           5.0         3.5          1.3         0.3     setosa
## 42           4.5         2.3          1.3         0.3     setosa
## 43           4.4         3.2          1.3         0.2     setosa
## 44           5.0         3.5          1.6         0.6     setosa
## 45           5.1         3.8          1.9         0.4     setosa
## 46           4.8         3.0          1.4         0.3     setosa
## 47           5.1         3.8          1.6         0.2     setosa
## 48           4.6         3.2          1.4         0.2     setosa
## 49           5.3         3.7          1.5         0.2     setosa
## 50           5.0         3.3          1.4         0.2     setosa
## 51           7.0         3.2          4.7         1.4 versicolor
## 52           6.4         3.2          4.5         1.5 versicolor
## 53           6.9         3.1          4.9         1.5 versicolor
## 54           5.5         2.3          4.0         1.3 versicolor
## 55           6.5         2.8          4.6         1.5 versicolor
## 56           5.7         2.8          4.5         1.3 versicolor
## 57           6.3         3.3          4.7         1.6 versicolor
## 58           4.9         2.4          3.3         1.0 versicolor
## 59           6.6         2.9          4.6         1.3 versicolor
## 60           5.2         2.7          3.9         1.4 versicolor
## 61           5.0         2.0          3.5         1.0 versicolor
## 62           5.9         3.0          4.2         1.5 versicolor
## 63           6.0         2.2          4.0         1.0 versicolor
## 64           6.1         2.9          4.7         1.4 versicolor
## 65           5.6         2.9          3.6         1.3 versicolor
## 66           6.7         3.1          4.4         1.4 versicolor
## 67           5.6         3.0          4.5         1.5 versicolor
## 68           5.8         2.7          4.1         1.0 versicolor
## 69           6.2         2.2          4.5         1.5 versicolor
## 70           5.6         2.5          3.9         1.1 versicolor
## 71           5.9         3.2          4.8         1.8 versicolor
## 72           6.1         2.8          4.0         1.3 versicolor
## 73           6.3         2.5          4.9         1.5 versicolor
## 74           6.1         2.8          4.7         1.2 versicolor
## 75           6.4         2.9          4.3         1.3 versicolor
## 76           6.6         3.0          4.4         1.4 versicolor
## 77           6.8         2.8          4.8         1.4 versicolor
## 78           6.7         3.0          5.0         1.7 versicolor
## 79           6.0         2.9          4.5         1.5 versicolor
## 80           5.7         2.6          3.5         1.0 versicolor
## 81           5.5         2.4          3.8         1.1 versicolor
## 82           5.5         2.4          3.7         1.0 versicolor
## 83           5.8         2.7          3.9         1.2 versicolor
## 84           6.0         2.7          5.1         1.6 versicolor
## 85           5.4         3.0          4.5         1.5 versicolor
## 86           6.0         3.4          4.5         1.6 versicolor
## 87           6.7         3.1          4.7         1.5 versicolor
## 88           6.3         2.3          4.4         1.3 versicolor
## 89           5.6         3.0          4.1         1.3 versicolor
## 90           5.5         2.5          4.0         1.3 versicolor
## 91           5.5         2.6          4.4         1.2 versicolor
## 92           6.1         3.0          4.6         1.4 versicolor
## 93           5.8         2.6          4.0         1.2 versicolor
## 94           5.0         2.3          3.3         1.0 versicolor
## 95           5.6         2.7          4.2         1.3 versicolor
## 96           5.7         3.0          4.2         1.2 versicolor
## 97           5.7         2.9          4.2         1.3 versicolor
## 98           6.2         2.9          4.3         1.3 versicolor
## 99           5.1         2.5          3.0         1.1 versicolor
## 100          5.7         2.8          4.1         1.3 versicolor
## 101          6.3         3.3          6.0         2.5  virginica
## 102          5.8         2.7          5.1         1.9  virginica
## 103          7.1         3.0          5.9         2.1  virginica
## 104          6.3         2.9          5.6         1.8  virginica
## 105          6.5         3.0          5.8         2.2  virginica
## 106          7.6         3.0          6.6         2.1  virginica
## 107          4.9         2.5          4.5         1.7  virginica
## 108          7.3         2.9          6.3         1.8  virginica
## 109          6.7         2.5          5.8         1.8  virginica
## 110          7.2         3.6          6.1         2.5  virginica
## 111          6.5         3.2          5.1         2.0  virginica
## 112          6.4         2.7          5.3         1.9  virginica
## 113          6.8         3.0          5.5         2.1  virginica
## 114          5.7         2.5          5.0         2.0  virginica
## 115          5.8         2.8          5.1         2.4  virginica
## 116          6.4         3.2          5.3         2.3  virginica
## 117          6.5         3.0          5.5         1.8  virginica
## 118          7.7         3.8          6.7         2.2  virginica
## 119          7.7         2.6          6.9         2.3  virginica
## 120          6.0         2.2          5.0         1.5  virginica
## 121          6.9         3.2          5.7         2.3  virginica
## 122          5.6         2.8          4.9         2.0  virginica
## 123          7.7         2.8          6.7         2.0  virginica
## 124          6.3         2.7          4.9         1.8  virginica
## 125          6.7         3.3          5.7         2.1  virginica
## 126          7.2         3.2          6.0         1.8  virginica
## 127          6.2         2.8          4.8         1.8  virginica
## 128          6.1         3.0          4.9         1.8  virginica
## 129          6.4         2.8          5.6         2.1  virginica
## 130          7.2         3.0          5.8         1.6  virginica
## 131          7.4         2.8          6.1         1.9  virginica
## 132          7.9         3.8          6.4         2.0  virginica
## 133          6.4         2.8          5.6         2.2  virginica
## 134          6.3         2.8          5.1         1.5  virginica
## 135          6.1         2.6          5.6         1.4  virginica
## 136          7.7         3.0          6.1         2.3  virginica
## 137          6.3         3.4          5.6         2.4  virginica
## 138          6.4         3.1          5.5         1.8  virginica
## 139          6.0         3.0          4.8         1.8  virginica
## 140          6.9         3.1          5.4         2.1  virginica
## 141          6.7         3.1          5.6         2.4  virginica
## 142          6.9         3.1          5.1         2.3  virginica
## 143          5.8         2.7          5.1         1.9  virginica
## 144          6.8         3.2          5.9         2.3  virginica
## 145          6.7         3.3          5.7         2.5  virginica
## 146          6.7         3.0          5.2         2.3  virginica
## 147          6.3         2.5          5.0         1.9  virginica
## 148          6.5         3.0          5.2         2.0  virginica
## 149          6.2         3.4          5.4         2.3  virginica
## 150          5.9         3.0          5.1         1.8  virginica</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="h2o.html#cb98-1"></a>index &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>,<span class="dv">25</span>), <span class="kw">sample</span>(<span class="dv">51</span><span class="op">:</span><span class="dv">100</span>,<span class="dv">25</span>), <span class="kw">sample</span>(<span class="dv">101</span><span class="op">:</span><span class="dv">150</span>,<span class="dv">25</span>))</span>
<span id="cb98-2"><a href="h2o.html#cb98-2"></a>irisTrain =<span class="st"> </span>iris[index,]</span>
<span id="cb98-3"><a href="h2o.html#cb98-3"></a>irisTest =<span class="st"> </span>iris[<span class="op">-</span>index,]</span>
<span id="cb98-4"><a href="h2o.html#cb98-4"></a></span>
<span id="cb98-5"><a href="h2o.html#cb98-5"></a>iris.h2oTrain &lt;-<span class="st"> </span><span class="kw">as.h2o</span>(irisTrain)</span></code></pre></div>
<pre><code>## Warning in use.package(&quot;data.table&quot;): data.table cannot be used without R
## package bit64 version 0.9.7 or higher. Please upgrade to take advangage of
## data.table speedups.</code></pre>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="h2o.html#cb101-1"></a>iris.h2oTest &lt;-<span class="st"> </span><span class="kw">as.h2o</span>(irisTest)</span></code></pre></div>
<pre><code>## Warning in use.package(&quot;data.table&quot;): data.table cannot be used without R
## package bit64 version 0.9.7 or higher. Please upgrade to take advangage of
## data.table speedups.</code></pre>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="h2o.html#cb104-1"></a>iris.nn &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span> ,</span>
<span id="cb104-2"><a href="h2o.html#cb104-2"></a>                            <span class="dt">y =</span> <span class="dv">5</span>, </span>
<span id="cb104-3"><a href="h2o.html#cb104-3"></a>                            <span class="dt">training_frame =</span> iris.h2oTrain, <span class="co"># data in H2O format</span></span>
<span id="cb104-4"><a href="h2o.html#cb104-4"></a>                            <span class="dt">validation_frame =</span> iris.h2oTest,</span>
<span id="cb104-5"><a href="h2o.html#cb104-5"></a>                            <span class="dt">activation =</span> <span class="st">&quot;Tanh&quot;</span>,</span>
<span id="cb104-6"><a href="h2o.html#cb104-6"></a>                            <span class="dt">hidden =</span> <span class="kw">c</span>(<span class="dv">5</span>), <span class="co"># one layer of 5 nodes</span></span>
<span id="cb104-7"><a href="h2o.html#cb104-7"></a>                            <span class="dt">l1 =</span> <span class="fl">1e-5</span>,</span>
<span id="cb104-8"><a href="h2o.html#cb104-8"></a>                            <span class="dt">epochs =</span> <span class="dv">100</span>, <span class="dt">variable_importances =</span> <span class="ot">TRUE</span>) <span class="co"># max. no. of epochs</span></span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="h2o.html#cb106-1"></a>iris.nn.cv &lt;-<span class="st"> </span><span class="kw">h2o.deeplearning</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span> ,</span>
<span id="cb106-2"><a href="h2o.html#cb106-2"></a>                            <span class="dt">y =</span> <span class="dv">5</span>, </span>
<span id="cb106-3"><a href="h2o.html#cb106-3"></a>                            <span class="dt">training_frame =</span> iris.h2oTrain, <span class="co"># data in H2O format</span></span>
<span id="cb106-4"><a href="h2o.html#cb106-4"></a>                            <span class="dt">validation_frame =</span> iris.h2oTest,</span>
<span id="cb106-5"><a href="h2o.html#cb106-5"></a>                            <span class="dt">activation =</span> <span class="st">&quot;Tanh&quot;</span>,</span>
<span id="cb106-6"><a href="h2o.html#cb106-6"></a>                            <span class="dt">hidden =</span> <span class="kw">c</span>(<span class="dv">5</span>), <span class="co"># one layer of 5 nodes</span></span>
<span id="cb106-7"><a href="h2o.html#cb106-7"></a>                            <span class="dt">l1 =</span> <span class="fl">1e-5</span>,</span>
<span id="cb106-8"><a href="h2o.html#cb106-8"></a>                            <span class="dt">nfolds =</span> <span class="dv">5</span>,</span>
<span id="cb106-9"><a href="h2o.html#cb106-9"></a>                            <span class="dt">epochs =</span> <span class="dv">100</span>) <span class="co"># max. no. of epochs</span></span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="h2o.html#cb108-1"></a>iris.nn<span class="op">@</span>parameters</span></code></pre></div>
<pre><code>## $model_id
## [1] &quot;DeepLearning_model_R_1621504187964_6&quot;
## 
## $training_frame
## [1] &quot;irisTrain_sid_a943_1&quot;
## 
## $validation_frame
## [1] &quot;irisTest_sid_a943_3&quot;
## 
## $activation
## [1] &quot;Tanh&quot;
## 
## $hidden
## [1] 5
## 
## $epochs
## [1] 100
## 
## $seed
## [1] &quot;140125080671732877&quot;
## 
## $l1
## [1] 1e-05
## 
## $distribution
## [1] &quot;multinomial&quot;
## 
## $stopping_metric
## [1] &quot;logloss&quot;
## 
## $categorical_encoding
## [1] &quot;OneHotInternal&quot;
## 
## $x
## [1] &quot;Sepal.Length&quot; &quot;Sepal.Width&quot;  &quot;Petal.Length&quot; &quot;Petal.Width&quot; 
## 
## $y
## [1] &quot;Species&quot;</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="h2o.html#cb110-1"></a><span class="kw">h2o.performance</span>(iris.nn, <span class="dt">train =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## H2OMultinomialMetrics: deeplearning
## ** Reported on training data. **
## ** Metrics reported on full training frame **
## 
## Training Set Metrics: 
## =====================
## 
## Extract training frame with `h2o.getFrame(&quot;irisTrain_sid_a943_1&quot;)`
## MSE: (Extract with `h2o.mse`) 0.04022331
## RMSE: (Extract with `h2o.rmse`) 0.2005575
## Logloss: (Extract with `h2o.logloss`) 0.1443866
## Mean Per-Class Error: 0.04
## Confusion Matrix: Extract with `h2o.confusionMatrix(&lt;model&gt;,train = TRUE)`)
## =========================================================================
## Confusion Matrix: Row labels: Actual class; Column labels: Predicted class
##            setosa versicolor virginica  Error     Rate
## setosa         25          0         0 0.0000 = 0 / 25
## versicolor      0         25         0 0.0000 = 0 / 25
## virginica       0          3        22 0.1200 = 3 / 25
## Totals         25         28        22 0.0400 = 3 / 75
## 
## Hit Ratio Table: Extract with `h2o.hit_ratio_table(&lt;model&gt;,train = TRUE)`
## =======================================================================
## Top-3 Hit Ratios: 
##   k hit_ratio
## 1 1  0.960000
## 2 2  1.000000
## 3 3  1.000000</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="h2o.html#cb112-1"></a><span class="kw">h2o.mse</span>(iris.nn, <span class="dt">train =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.04022331</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="h2o.html#cb114-1"></a><span class="kw">h2o.mse</span>(iris.nn, <span class="dt">valid =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.03606636</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="h2o.html#cb116-1"></a><span class="kw">h2o.mse</span>(iris.nn.cv, <span class="dt">xval =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.08550383</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="h2o.html#cb118-1"></a><span class="kw">h2o.varimp</span>(iris.nn)</span></code></pre></div>
<pre><code>## Variable Importances: 
##       variable relative_importance scaled_importance percentage
## 1 Petal.Length            1.000000          1.000000   0.404590
## 2  Petal.Width            0.579513          0.579513   0.234465
## 3 Sepal.Length            0.559525          0.559525   0.226378
## 4  Sepal.Width            0.332603          0.332603   0.134568</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="h2o.html#cb120-1"></a><span class="co"># now make a prediction</span></span>
<span id="cb120-2"><a href="h2o.html#cb120-2"></a>predictionsTrain &lt;-<span class="st"> </span><span class="kw">h2o.predict</span>(iris.nn, iris.h2oTrain)</span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="h2o.html#cb122-1"></a>predictionsTrain</span></code></pre></div>
<pre><code>##   predict    setosa  versicolor    virginica
## 1  setosa 0.9605705 0.039408090 2.136172e-05
## 2  setosa 0.9941566 0.005842733 6.915862e-07
## 3  setosa 0.9932530 0.006746304 7.382293e-07
## 4  setosa 0.9938170 0.006182201 7.907678e-07
## 5  setosa 0.9950551 0.004944093 8.316701e-07
## 6  setosa 0.9937289 0.006270050 1.058508e-06
## 
## [75 rows x 4 columns]</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="h2o.html#cb124-1"></a>predictionsTest &lt;-<span class="st"> </span><span class="kw">h2o.predict</span>(iris.nn, iris.h2oTest)</span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="h2o.html#cb126-1"></a>predictionsTest</span></code></pre></div>
<pre><code>##   predict    setosa  versicolor    virginica
## 1  setosa 0.9947001 0.005298876 9.823197e-07
## 2  setosa 0.9930255 0.006973262 1.263730e-06
## 3  setosa 0.9945754 0.005423825 7.557000e-07
## 4  setosa 0.9932355 0.006763449 1.040563e-06
## 5  setosa 0.9925999 0.007398490 1.571062e-06
## 6  setosa 0.9941181 0.005880774 1.130556e-06
## 
## [75 rows x 4 columns]</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="h2o.html#cb128-1"></a>yhatTrain =<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">as.matrix</span>(predictionsTrain<span class="op">$</span>predict))</span>
<span id="cb128-2"><a href="h2o.html#cb128-2"></a><span class="kw">confusionMatrix</span>(yhatTrain, irisTrain<span class="op">$</span>Species)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##             Reference
## Prediction   setosa versicolor virginica
##   setosa         25          0         0
##   versicolor      0         25         3
##   virginica       0          0        22
## 
## Overall Statistics
##                                           
##                Accuracy : 0.96            
##                  95% CI : (0.8875, 0.9917)
##     No Information Rate : 0.3333          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.94            
##                                           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: setosa Class: versicolor Class: virginica
## Sensitivity                 1.0000            1.0000           0.8800
## Specificity                 1.0000            0.9400           1.0000
## Pos Pred Value              1.0000            0.8929           1.0000
## Neg Pred Value              1.0000            1.0000           0.9434
## Prevalence                  0.3333            0.3333           0.3333
## Detection Rate              0.3333            0.3333           0.2933
## Detection Prevalence        0.3333            0.3733           0.2933
## Balanced Accuracy           1.0000            0.9700           0.9400</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="h2o.html#cb130-1"></a>yhatTest =<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">as.matrix</span>(predictionsTest<span class="op">$</span>predict))</span>
<span id="cb130-2"><a href="h2o.html#cb130-2"></a><span class="kw">confusionMatrix</span>(yhatTest, irisTest<span class="op">$</span>Species)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##             Reference
## Prediction   setosa versicolor virginica
##   setosa         25          0         0
##   versicolor      0         25         3
##   virginica       0          0        22
## 
## Overall Statistics
##                                           
##                Accuracy : 0.96            
##                  95% CI : (0.8875, 0.9917)
##     No Information Rate : 0.3333          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.94            
##                                           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: setosa Class: versicolor Class: virginica
## Sensitivity                 1.0000            1.0000           0.8800
## Specificity                 1.0000            0.9400           1.0000
## Pos Pred Value              1.0000            0.8929           1.0000
## Neg Pred Value              1.0000            1.0000           0.9434
## Prevalence                  0.3333            0.3333           0.3333
## Detection Rate              0.3333            0.3333           0.2933
## Detection Prevalence        0.3333            0.3733           0.2933
## Balanced Accuracy           1.0000            0.9700           0.9400</code></pre>
<div id="grid-search-for-complexity" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Grid Search for Complexity</h3>
<p><a href="https://h2o-release.s3.amazonaws.com/h2o/master/3190/docs-website/h2o-docs/booklets/DeepLearning_Vignette.pdf" class="uri">https://h2o-release.s3.amazonaws.com/h2o/master/3190/docs-website/h2o-docs/booklets/DeepLearning_Vignette.pdf</a></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="h2o.html#cb132-1"></a>hidden_opt &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">3</span>), <span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>, <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>),<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>), <span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">4</span>), <span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">4</span>))</span>
<span id="cb132-2"><a href="h2o.html#cb132-2"></a>hyper_params &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">hidden =</span> hidden_opt)</span>
<span id="cb132-3"><a href="h2o.html#cb132-3"></a>model_grid &lt;-<span class="st"> </span><span class="kw">h2o.grid</span>(<span class="st">&quot;deeplearning&quot;</span>,</span>
<span id="cb132-4"><a href="h2o.html#cb132-4"></a>  <span class="dt">hyper_params =</span> hyper_params,</span>
<span id="cb132-5"><a href="h2o.html#cb132-5"></a>  <span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span> ,</span>
<span id="cb132-6"><a href="h2o.html#cb132-6"></a>  <span class="dt">y =</span> <span class="dv">5</span>, </span>
<span id="cb132-7"><a href="h2o.html#cb132-7"></a>  <span class="dt">training_frame =</span> iris.h2oTrain, <span class="co"># data in H2O format</span></span>
<span id="cb132-8"><a href="h2o.html#cb132-8"></a>  <span class="dt">validation_frame =</span> iris.h2oTest,</span>
<span id="cb132-9"><a href="h2o.html#cb132-9"></a>  <span class="dt">activation =</span> <span class="st">&quot;Tanh&quot;</span>,</span>
<span id="cb132-10"><a href="h2o.html#cb132-10"></a>  <span class="dt">seed =</span> <span class="dv">1</span>, <span class="dt">reproducible =</span> <span class="ot">TRUE</span>, <span class="dt">nfolds =</span> <span class="dv">5</span></span>
<span id="cb132-11"><a href="h2o.html#cb132-11"></a>  )</span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="h2o.html#cb134-1"></a>model_grid</span></code></pre></div>
<pre><code>## H2O Grid Details
## ================
## 
## Grid ID: Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8 
## Used hyper parameters: 
##   -  hidden 
## Number of models: 14 
## Number of failed models: 0 
## 
## Hyper-Parameter Search Summary: ordered by increasing logloss
##    hidden
## 1  [6, 4]
## 2    [10]
## 3     [9]
## 4  [5, 4]
## 5     [8]
## 6  [4, 4]
## 7     [4]
## 8     [5]
## 9     [7]
## 10 [3, 4]
## 11    [1]
## 12    [6]
## 13    [2]
## 14    [3]
##                                                                  model_ids
## 1  Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8_model_14
## 2  Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8_model_10
## 3   Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8_model_9
## 4  Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8_model_13
## 5   Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8_model_8
## 6  Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8_model_12
## 7   Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8_model_4
## 8   Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8_model_5
## 9   Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8_model_7
## 10 Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8_model_11
## 11  Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8_model_1
## 12  Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8_model_6
## 13  Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8_model_2
## 14  Grid_DeepLearning_irisTrain_sid_a943_1_model_R_1621504187964_8_model_3
##                logloss
## 1  0.30340859353378963
## 2   0.3241505862508419
## 3   0.3762406263763066
## 4   0.3859649879467963
## 5  0.41505146300210605
## 6  0.42160893762650176
## 7  0.44643795766409294
## 8   0.5033872528865022
## 9   0.5453880844019323
## 10  0.5799886955035108
## 11  0.5823825581709984
## 12  0.6108454650879463
## 13   0.702354413999542
## 14  0.7400050923793164</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="h2o.html#cb136-1"></a>model1 =<span class="st"> </span><span class="kw">h2o.getModel</span>(model_grid<span class="op">@</span>model_ids[[<span class="dv">1</span>]])</span>
<span id="cb136-2"><a href="h2o.html#cb136-2"></a><span class="kw">h2o.mse</span>(model1, <span class="dt">xval =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.09175803</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="neuralnet.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="keras.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Keras.pdf", "Keras.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
