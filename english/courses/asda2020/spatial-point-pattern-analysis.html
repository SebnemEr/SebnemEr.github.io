<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Spatial Point Pattern Analysis | Applied Spatial Data Analysis - Spatial Point and Lattice Data</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Spatial Point Pattern Analysis | Applied Spatial Data Analysis - Spatial Point and Lattice Data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Spatial Point Pattern Analysis | Applied Spatial Data Analysis - Spatial Point and Lattice Data" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Dr Sebnem Er" />


<meta name="date" content="2020-10-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="spatial-lattice-data-analysis.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Spatial Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html"><i class="fa fa-check"></i><b>2</b> Spatial Point Pattern Analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#prerequisites"><i class="fa fa-check"></i><b>2.1</b> Prerequisites</a></li>
<li class="chapter" data-level="2.2" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#datasets---readily-available-imported-simulated-datasets"><i class="fa fa-check"></i><b>2.2</b> Datasets - Readily Available, Imported, Simulated Datasets</a><ul>
<li class="chapter" data-level="2.2.1" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#swedishpines-dataset-from-spatstat.data-library"><i class="fa fa-check"></i><b>2.2.1</b> Swedishpines Dataset from spatstat.data library</a></li>
<li class="chapter" data-level="2.2.2" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#clinics-dataset-using-simple-features-sf"><i class="fa fa-check"></i><b>2.2.2</b> Clinics Dataset Using Simple Features (SF)</a></li>
<li class="chapter" data-level="2.2.3" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#simulated-datasets"><i class="fa fa-check"></i><b>2.2.3</b> Simulated Datasets</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#plotting-datasets"><i class="fa fa-check"></i><b>2.3</b> Plotting Datasets</a><ul>
<li class="chapter" data-level="2.3.1" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#basic-plot-function"><i class="fa fa-check"></i><b>2.3.1</b> Basic plot() function</a></li>
<li class="chapter" data-level="2.3.2" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#basic-ggplot-function---sf-object"><i class="fa fa-check"></i><b>2.3.2</b> Basic ggplot() function - (sf) object</a></li>
<li class="chapter" data-level="2.3.3" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#ggplot-function-with-a-bounding-box---sf-object"><i class="fa fa-check"></i><b>2.3.3</b> ggplot() function with a bounding box - (sf) object</a></li>
<li class="chapter" data-level="2.3.4" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#ggplot-with-electoral-wards-shape-file"><i class="fa fa-check"></i><b>2.3.4</b> ggplot() with Electoral Wards Shape File</a></li>
<li class="chapter" data-level="2.3.5" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#plotting-with-google-maps"><i class="fa fa-check"></i><b>2.3.5</b> Plotting with google maps:</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#quadrat-analysis---quadrat-counts-and-tests"><i class="fa fa-check"></i><b>2.4</b> Quadrat Analysis - Quadrat Counts and Tests</a><ul>
<li class="chapter" data-level="2.4.1" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#swp-dataset"><i class="fa fa-check"></i><b>2.4.1</b> swp dataset</a></li>
<li class="chapter" data-level="2.4.2" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#simulated-csr-pattern"><i class="fa fa-check"></i><b>2.4.2</b> Simulated CSR Pattern</a></li>
<li class="chapter" data-level="2.4.3" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#simulated-cluster-pattern"><i class="fa fa-check"></i><b>2.4.3</b> Simulated Cluster Pattern</a></li>
<li class="chapter" data-level="2.4.4" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#simulated-regular-pattern"><i class="fa fa-check"></i><b>2.4.4</b> Simulated Regular Pattern</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#kernel-density-smoothing"><i class="fa fa-check"></i><b>2.5</b> Kernel Density Smoothing</a><ul>
<li class="chapter" data-level="2.5.1" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#csr-pattern"><i class="fa fa-check"></i><b>2.5.1</b> CSR Pattern</a></li>
<li class="chapter" data-level="2.5.2" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#regular-pattern"><i class="fa fa-check"></i><b>2.5.2</b> Regular Pattern</a></li>
<li class="chapter" data-level="2.5.3" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#cluster-pattern"><i class="fa fa-check"></i><b>2.5.3</b> Cluster Pattern</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#kernel-smoothing-with-a-covariate"><i class="fa fa-check"></i><b>2.6</b> Kernel Smoothing with a Covariate</a><ul>
<li class="chapter" data-level="2.6.1" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#tropical-rain-forest-trees-dataset"><i class="fa fa-check"></i><b>2.6.1</b> Tropical rain forest trees dataset</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#distance-measures-and-tests"><i class="fa fa-check"></i><b>2.7</b> Distance Measures and Tests</a><ul>
<li class="chapter" data-level="2.7.1" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#e2e-distances"><i class="fa fa-check"></i><b>2.7.1</b> e2e Distances</a></li>
<li class="chapter" data-level="2.7.2" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#p2e-distances"><i class="fa fa-check"></i><b>2.7.2</b> p2e Distances</a></li>
<li class="chapter" data-level="2.7.3" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#clark-and-evans-index-and-test"><i class="fa fa-check"></i><b>2.7.3</b> Clark and Evans Index and Test</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#g-function"><i class="fa fa-check"></i><b>2.8</b> G Function</a><ul>
<li class="chapter" data-level="2.8.1" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#simulated-csr-pattern-2"><i class="fa fa-check"></i><b>2.8.1</b> Simulated CSR Pattern</a></li>
<li class="chapter" data-level="2.8.2" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#simulated-regular-pattern-2"><i class="fa fa-check"></i><b>2.8.2</b> Simulated Regular Pattern</a></li>
<li class="chapter" data-level="2.8.3" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#simulated-cluster-pattern-2"><i class="fa fa-check"></i><b>2.8.3</b> Simulated Cluster Pattern</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#f-function"><i class="fa fa-check"></i><b>2.9</b> F Function</a><ul>
<li class="chapter" data-level="2.9.1" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#simulated-csr-pattern-3"><i class="fa fa-check"></i><b>2.9.1</b> Simulated CSR Pattern</a></li>
<li class="chapter" data-level="2.9.2" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#simulated-regular-pattern-3"><i class="fa fa-check"></i><b>2.9.2</b> Simulated Regular Pattern</a></li>
<li class="chapter" data-level="2.9.3" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#simulated-cluster-pattern-3"><i class="fa fa-check"></i><b>2.9.3</b> Simulated Cluster Pattern</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#ripleys-k-function"><i class="fa fa-check"></i><b>2.10</b> Ripley’s K Function</a><ul>
<li class="chapter" data-level="2.10.1" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#simulated-csr-pattern-4"><i class="fa fa-check"></i><b>2.10.1</b> Simulated CSR Pattern</a></li>
<li class="chapter" data-level="2.10.2" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#simulated-regular-pattern-4"><i class="fa fa-check"></i><b>2.10.2</b> Simulated Regular Pattern</a></li>
<li class="chapter" data-level="2.10.3" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#simulated-cluster-pattern-4"><i class="fa fa-check"></i><b>2.10.3</b> Simulated Cluster Pattern</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="spatial-point-pattern-analysis.html"><a href="spatial-point-pattern-analysis.html#references"><i class="fa fa-check"></i><b>2.11</b> References:</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="spatial-lattice-data-analysis.html"><a href="spatial-lattice-data-analysis.html"><i class="fa fa-check"></i><b>3</b> Spatial Lattice Data Analysis</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Spatial Data Analysis - Spatial Point and Lattice Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-point-pattern-analysis" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Spatial Point Pattern Analysis</h1>
<div id="prerequisites" class="section level2">
<h2><span class="header-section-number">2.1</span> Prerequisites</h2>
<p>You need to have the following R packages installed and recalled into your library:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="spatial-point-pattern-analysis.html#cb1-1"></a><span class="kw">library</span>(sf)</span>
<span id="cb1-2"><a href="spatial-point-pattern-analysis.html#cb1-2"></a><span class="kw">library</span>(spatstat)</span>
<span id="cb1-3"><a href="spatial-point-pattern-analysis.html#cb1-3"></a><span class="kw">library</span>(spatstat.data)</span>
<span id="cb1-4"><a href="spatial-point-pattern-analysis.html#cb1-4"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="spatial-point-pattern-analysis.html#cb1-5"></a><span class="kw">library</span>(sp)</span>
<span id="cb1-6"><a href="spatial-point-pattern-analysis.html#cb1-6"></a><span class="kw">library</span>(animation)</span>
<span id="cb1-7"><a href="spatial-point-pattern-analysis.html#cb1-7"></a><span class="kw">library</span>(plotrix)</span></code></pre></div>
</div>
<div id="datasets---readily-available-imported-simulated-datasets" class="section level2">
<h2><span class="header-section-number">2.2</span> Datasets - Readily Available, Imported, Simulated Datasets</h2>
<div id="swedishpines-dataset-from-spatstat.data-library" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Swedishpines Dataset from spatstat.data library</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r bg-danger"><code class="sourceCode r"><span id="cb2-1"><a href="spatial-point-pattern-analysis.html#cb2-1"></a><span class="kw">data</span>(swedishpines)</span>
<span id="cb2-2"><a href="spatial-point-pattern-analysis.html#cb2-2"></a>swp =<span class="st"> </span>spatstat<span class="op">::</span><span class="kw">rescale</span>(swedishpines)</span>
<span id="cb2-3"><a href="spatial-point-pattern-analysis.html#cb2-3"></a><span class="kw">class</span>(swp)</span></code></pre></div>
<pre class="bg-warning"><code>## [1] &quot;ppp&quot;</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r bg-danger"><code class="sourceCode r"><span id="cb4-1"><a href="spatial-point-pattern-analysis.html#cb4-1"></a><span class="kw">summary</span>(swp)</span></code></pre></div>
<pre class="bg-warning"><code>## Planar point pattern:  71 points
## Average intensity 0.7395833 points per square metre
## 
## Coordinates are given to 1 decimal place
## i.e. rounded to the nearest multiple of 0.1 metres
## 
## Window: rectangle = [0, 9.6] x [0, 10] metres
## Window area = 96 square metres
## Unit of length: 1 metre</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r bg-danger"><code class="sourceCode r"><span id="cb6-1"><a href="spatial-point-pattern-analysis.html#cb6-1"></a><span class="kw">plot</span>(swp)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="clinics-dataset-using-simple-features-sf" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Clinics Dataset Using Simple Features (SF)</h3>
<p>Download the data from the following:</p>
<p><a href="https://web1.capetown.gov.za/web1/OpenDataPortal/DatasetDetail?DatasetName=Clinics" class="uri">https://web1.capetown.gov.za/web1/OpenDataPortal/DatasetDetail?DatasetName=Clinics</a></p>
<p>Extract the data frame into R:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="spatial-point-pattern-analysis.html#cb7-1"></a><span class="kw">library</span>(sf)</span>
<span id="cb7-2"><a href="spatial-point-pattern-analysis.html#cb7-2"></a>clinics_sf =<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;C:/Users/01438475/Google Drive/UCTcourses/ASDA/DataSets/Clinics/SL_CLNC.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `SL_CLNC&#39; from data source `C:\Users\01438475\Google Drive\UCTcourses\ASDA\DataSets\Clinics\SL_CLNC.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 149 features and 5 fields
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 18.34268 ymin: -34.19491 xmax: 18.90847 ymax: -33.51262
## geographic CRS: WGS 84</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="spatial-point-pattern-analysis.html#cb9-1"></a>clinics_sf</span></code></pre></div>
<pre><code>## Simple feature collection with 149 features and 5 fields
## geometry type:  POINT
## dimension:      XY
## bbox:           xmin: 18.34268 ymin: -34.19491 xmax: 18.90847 ymax: -33.51262
## geographic CRS: WGS 84
## First 10 features:
##                                        LCTN              ATHY
## 1           C/O Adam/ Liedeman Street Mamre              PAWC
## 2                 Cnr Hermes &amp; GrosvenorAve CITY OF CAPE TOWN
## 3            Hassen Kahn Ave Rusthof Strand              PAWC
## 4              61 Central Circle, Fish Hoek CITY OF CAPE TOWN
## 5                     Simon Street, Nomzamo CITY OF CAPE TOWN
## 6  C/O Musical and Hospital Street Macassar              PAWC
## 7            28 Church Street Somerset West CITY OF CAPE TOWN
## 8                       Fagan Street Strand CITY OF CAPE TOWN
## 9    Karbonkel Road, CMC Building, Hout Bay              PAWC
## 10                Midmar Street Groenvallei CITY OF CAPE TOWN
##                      NAME                CLASS       RGN
## 1               MAMRE CDC Community Day Centre   Western
## 2        SAXON SEA CLINIC               Clinic   Western
## 3            GUSTROUW CDC Community Day Centre   Eastern
## 4        FISH HOEK CLINIC               Clinic  Southern
## 5              IKWEZI CDC Community Day Centre   Eastern
## 6            MACASSAR CDC Community Day Centre   Eastern
## 7    SOMERSET WEST CLINIC               Clinic   Eastern
## 8  FAGAN STREET SATELLITE            Satellite   Eastern
## 9    HOUT BAY HARBOUR CDC Community Day Centre  Southern
## 10  GROENVALLEI SATELLITE            Satellite Tygerberg
##                      geometry
## 1  POINT (18.47692 -33.51262)
## 2  POINT (18.48881 -33.55012)
## 3  POINT (18.85211 -34.13472)
## 4  POINT (18.42632 -34.13669)
## 5  POINT (18.86622 -34.11375)
## 6  POINT (18.76369 -34.06105)
## 7  POINT (18.84814 -34.08579)
## 8   POINT (18.82979 -34.1162)
## 9   POINT (18.34268 -34.0549)
## 10 POINT (18.66701 -33.89165)</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="spatial-point-pattern-analysis.html#cb11-1"></a><span class="kw">class</span>(clinics_sf)</span></code></pre></div>
<pre><code>## [1] &quot;sf&quot;         &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="spatial-point-pattern-analysis.html#cb13-1"></a><span class="kw">summary</span>(clinics_sf)</span></code></pre></div>
<pre><code>##      LCTN               ATHY               NAME              CLASS          
##  Length:149         Length:149         Length:149         Length:149        
##  Class :character   Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character   Mode  :character  
##      RGN                     geometry  
##  Length:149         POINT        :149  
##  Class :character   epsg:4326    :  0  
##  Mode  :character   +proj=long...:  0</code></pre>
</div>
<div id="simulated-datasets" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Simulated Datasets</h3>
<div id="csr-data-points" class="section level4">
<h4><span class="header-section-number">2.2.3.1</span> CSR Data Points</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="spatial-point-pattern-analysis.html#cb15-1"></a><span class="kw">set.seed</span>(<span class="dv">135</span>)</span>
<span id="cb15-2"><a href="spatial-point-pattern-analysis.html#cb15-2"></a>xy_csr &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">80</span>), <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb15-3"><a href="spatial-point-pattern-analysis.html#cb15-3"></a>pp_csr &lt;-<span class="st"> </span><span class="kw">as.ppp</span>(xy_csr, <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb15-4"><a href="spatial-point-pattern-analysis.html#cb15-4"></a><span class="kw">plot</span>(pp_csr)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="regular-data-points" class="section level4">
<h4><span class="header-section-number">2.2.3.2</span> Regular Data Points</h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="spatial-point-pattern-analysis.html#cb16-1"></a>regular &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;C:/Users/01438475/Google Drive/UCTcourses/ASDA/regular.csv&quot;</span>)</span>
<span id="cb16-2"><a href="spatial-point-pattern-analysis.html#cb16-2"></a>xy_regular &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">cbind</span>(regular<span class="op">$</span>X,regular<span class="op">$</span>Y), <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb16-3"><a href="spatial-point-pattern-analysis.html#cb16-3"></a>pp_regular &lt;-<span class="st"> </span><span class="kw">as.ppp</span>(xy_regular, <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb16-4"><a href="spatial-point-pattern-analysis.html#cb16-4"></a><span class="kw">plot</span>(pp_regular)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="cluster-data-points" class="section level4">
<h4><span class="header-section-number">2.2.3.3</span> Cluster Data Points</h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="spatial-point-pattern-analysis.html#cb17-1"></a>cluster &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;C:/Users/01438475/Google Drive/UCTcourses/ASDA/cluster.csv&quot;</span>)</span>
<span id="cb17-2"><a href="spatial-point-pattern-analysis.html#cb17-2"></a>xy_cluster &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">cbind</span>(cluster<span class="op">$</span>X,cluster<span class="op">$</span>Y), <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb17-3"><a href="spatial-point-pattern-analysis.html#cb17-3"></a>pp_cluster &lt;-<span class="st"> </span><span class="kw">as.ppp</span>(xy_cluster, <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb17-4"><a href="spatial-point-pattern-analysis.html#cb17-4"></a><span class="kw">plot</span>(pp_cluster)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="plotting-datasets" class="section level2">
<h2><span class="header-section-number">2.3</span> Plotting Datasets</h2>
<div id="basic-plot-function" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Basic plot() function</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r bg-danger"><code class="sourceCode r"><span id="cb18-1"><a href="spatial-point-pattern-analysis.html#cb18-1"></a><span class="kw">plot</span>(swp)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="basic-ggplot-function---sf-object" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Basic ggplot() function - (sf) object</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="spatial-point-pattern-analysis.html#cb19-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb19-2"><a href="spatial-point-pattern-analysis.html#cb19-2"></a>plot1 =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-3"><a href="spatial-point-pattern-analysis.html#cb19-3"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> clinics_sf, <span class="dt">size =</span> <span class="fl">.8</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-4"><a href="spatial-point-pattern-analysis.html#cb19-4"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Location of Cape Town clinics - 2016&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-5"><a href="spatial-point-pattern-analysis.html#cb19-5"></a><span class="st">  </span><span class="co"># not specifying crs here, coord_sf will use the CRS defined in the first layer = &quot;+proj=longlat +datum=WGS84 +no_defs&quot;</span></span>
<span id="cb19-6"><a href="spatial-point-pattern-analysis.html#cb19-6"></a><span class="st">  </span><span class="kw">coord_sf</span>() </span>
<span id="cb19-7"><a href="spatial-point-pattern-analysis.html#cb19-7"></a>plot1</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="ggplot-function-with-a-bounding-box---sf-object" class="section level3">
<h3><span class="header-section-number">2.3.3</span> ggplot() function with a bounding box - (sf) object</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="spatial-point-pattern-analysis.html#cb20-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb20-2"><a href="spatial-point-pattern-analysis.html#cb20-2"></a>plot2 =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-3"><a href="spatial-point-pattern-analysis.html#cb20-3"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> clinics_sf, <span class="dt">size =</span> <span class="fl">.8</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-4"><a href="spatial-point-pattern-analysis.html#cb20-4"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Location of Cape Town clinics - 2016&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-5"><a href="spatial-point-pattern-analysis.html#cb20-5"></a><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">18.34</span>, <span class="fl">18.91</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">34.19</span>, <span class="fl">-33.51262</span>)) <span class="op">+</span></span>
<span id="cb20-6"><a href="spatial-point-pattern-analysis.html#cb20-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb20-7"><a href="spatial-point-pattern-analysis.html#cb20-7"></a>        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb20-8"><a href="spatial-point-pattern-analysis.html#cb20-8"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">fill=</span><span class="ot">NA</span>))</span>
<span id="cb20-9"><a href="spatial-point-pattern-analysis.html#cb20-9"></a>plot2</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="ggplot-with-electoral-wards-shape-file" class="section level3">
<h3><span class="header-section-number">2.3.4</span> ggplot() with Electoral Wards Shape File</h3>
<p>In order to plot using the electoral wards polygons, we need the sf data frame to be converted into Spatial Points Data Frame (sp).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="spatial-point-pattern-analysis.html#cb21-1"></a>clinics_sp &lt;-<span class="st"> </span><span class="kw">as</span>(clinics_sf, <span class="dt">Class =</span> <span class="st">&quot;Spatial&quot;</span>)</span>
<span id="cb21-2"><a href="spatial-point-pattern-analysis.html#cb21-2"></a><span class="kw">class</span>(clinics_sp)</span></code></pre></div>
<pre><code>## [1] &quot;SpatialPointsDataFrame&quot;
## attr(,&quot;package&quot;)
## [1] &quot;sp&quot;</code></pre>
<p>Download the CPT electoral wards and import the shape file as follows:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="spatial-point-pattern-analysis.html#cb23-1"></a><span class="kw">library</span>(sf)</span>
<span id="cb23-2"><a href="spatial-point-pattern-analysis.html#cb23-2"></a>ct.wards_sf =<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;C:/Users/01438475/Google Drive/UCTcourses/ASDA/DataSets/sa/CPT/electoral wards for cpt.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `electoral wards for cpt&#39; from data source `C:\Users\01438475\Google Drive\UCTcourses\ASDA\DataSets\sa\CPT\electoral wards for cpt.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 111 features and 9 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 18.30722 ymin: -34.35834 xmax: 19.00467 ymax: -33.47128
## CRS:            NA</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="spatial-point-pattern-analysis.html#cb25-1"></a><span class="kw">st_geometry_type</span>(ct.wards_sf)</span></code></pre></div>
<pre><code>##   [1] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##   [6] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [11] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [16] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [21] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [26] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [31] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [36] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [41] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [46] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [51] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [56] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [61] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [66] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [71] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [76] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [81] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [86] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [91] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
##  [96] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
## [101] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
## [106] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
## [111] MULTIPOLYGON
## 18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="spatial-point-pattern-analysis.html#cb27-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb27-2"><a href="spatial-point-pattern-analysis.html#cb27-2"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb27-3"><a href="spatial-point-pattern-analysis.html#cb27-3"></a><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">data =</span> ct.wards_sf, <span class="dt">size =</span> <span class="fl">.5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb27-4"><a href="spatial-point-pattern-analysis.html#cb27-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clinics_sp<span class="op">@</span>coords[,<span class="dv">1</span>], <span class="dt">y =</span> clinics_sp<span class="op">@</span>coords[,<span class="dv">2</span>]),</span>
<span id="cb27-5"><a href="spatial-point-pattern-analysis.html#cb27-5"></a>             <span class="dt">data =</span> clinics_sp<span class="op">@</span>data, <span class="dt">alpha =</span> <span class="dv">1</span>,<span class="dt">size=</span><span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span><span class="st"> </span></span>
<span id="cb27-6"><a href="spatial-point-pattern-analysis.html#cb27-6"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Spatial locations of Cape Town clinics within wards&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb27-7"><a href="spatial-point-pattern-analysis.html#cb27-7"></a><span class="st">  </span><span class="kw">coord_sf</span>()</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="plotting-with-google-maps" class="section level3">
<h3><span class="header-section-number">2.3.5</span> Plotting with google maps:</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="spatial-point-pattern-analysis.html#cb28-1"></a><span class="kw">require</span>(<span class="st">&quot;maps&quot;</span>)</span>
<span id="cb28-2"><a href="spatial-point-pattern-analysis.html#cb28-2"></a><span class="kw">require</span>(<span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
<p>First specify the outer boundaries of Google Map</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="spatial-point-pattern-analysis.html#cb29-1"></a><span class="kw">require</span>(<span class="st">&quot;ggmap&quot;</span>)</span>
<span id="cb29-2"><a href="spatial-point-pattern-analysis.html#cb29-2"></a>caLongLat &lt;-<span class="kw">c</span>(<span class="kw">bbox</span>(clinics_sp)[<span class="dv">1</span>,<span class="dv">1</span>], <span class="kw">bbox</span>(clinics_sp)[<span class="dv">2</span>,<span class="dv">1</span>], <span class="kw">bbox</span>(clinics_sp)[<span class="dv">1</span>,<span class="dv">2</span>],<span class="kw">bbox</span>(clinics_sp)[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb29-3"><a href="spatial-point-pattern-analysis.html#cb29-3"></a>caLongLat</span></code></pre></div>
<pre><code>## [1]  18.34268 -34.19491  18.90847 -33.51262</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="spatial-point-pattern-analysis.html#cb31-1"></a>caLongLat&lt;-<span class="kw">c</span>(<span class="dv">18</span>, <span class="fl">-34.3</span>,  <span class="dv">19</span>, <span class="fl">-33.2</span>)</span>
<span id="cb31-2"><a href="spatial-point-pattern-analysis.html#cb31-2"></a>map &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="dt">location =</span> caLongLat)</span></code></pre></div>
<p>Google Map Plot</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="spatial-point-pattern-analysis.html#cb32-1"></a>mapPoints &lt;-<span class="st"> </span><span class="kw">ggmap</span>(map) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-2"><a href="spatial-point-pattern-analysis.html#cb32-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> clinics_sp<span class="op">@</span>coords[,<span class="dv">1</span>], <span class="dt">y =</span> clinics_sp<span class="op">@</span>coords[,<span class="dv">2</span>]),</span>
<span id="cb32-3"><a href="spatial-point-pattern-analysis.html#cb32-3"></a>             <span class="dt">data =</span> clinics_sp<span class="op">@</span>data, <span class="dt">alpha =</span> <span class="fl">0.7</span>,<span class="dt">size=</span><span class="dv">2</span>)<span class="op">+</span><span class="st"> </span></span>
<span id="cb32-4"><a href="spatial-point-pattern-analysis.html#cb32-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Spatial location of clinics&quot;</span>,</span>
<span id="cb32-5"><a href="spatial-point-pattern-analysis.html#cb32-5"></a>       <span class="dt">y=</span><span class="st">&quot;Latitude&quot;</span>,<span class="dt">x=</span><span class="st">&quot;Longtitude&quot;</span> )</span>
<span id="cb32-6"><a href="spatial-point-pattern-analysis.html#cb32-6"></a></span>
<span id="cb32-7"><a href="spatial-point-pattern-analysis.html#cb32-7"></a>mapPoints</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="quadrat-analysis---quadrat-counts-and-tests" class="section level2">
<h2><span class="header-section-number">2.4</span> Quadrat Analysis - Quadrat Counts and Tests</h2>
<div id="swp-dataset" class="section level3">
<h3><span class="header-section-number">2.4.1</span> swp dataset</h3>
<p>Quadrat counts:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="spatial-point-pattern-analysis.html#cb33-1"></a>Q3x3 =<span class="st"> </span><span class="kw">quadratcount</span>(swp, <span class="dt">nx=</span><span class="dv">3</span>, <span class="dt">ny=</span><span class="dv">3</span>)</span>
<span id="cb33-2"><a href="spatial-point-pattern-analysis.html#cb33-2"></a><span class="kw">plot</span>(swp)</span>
<span id="cb33-3"><a href="spatial-point-pattern-analysis.html#cb33-3"></a><span class="kw">plot</span>(Q3x3, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="spatial-point-pattern-analysis.html#cb34-1"></a><span class="co"># Plot the density</span></span>
<span id="cb34-2"><a href="spatial-point-pattern-analysis.html#cb34-2"></a>cl &lt;-<span class="st">  </span><span class="kw">interp.colours</span>(<span class="kw">c</span>(<span class="st">&quot;lightyellow&quot;</span>, <span class="st">&quot;orange&quot;</span> ,<span class="st">&quot;red&quot;</span>), <span class="dv">20</span>)</span>
<span id="cb34-3"><a href="spatial-point-pattern-analysis.html#cb34-3"></a></span>
<span id="cb34-4"><a href="spatial-point-pattern-analysis.html#cb34-4"></a><span class="kw">plot</span>( <span class="kw">intensity</span>(Q3x3, <span class="dt">image=</span><span class="ot">TRUE</span>), <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">col=</span>cl, <span class="dt">main=</span><span class="ot">NULL</span>)</span>
<span id="cb34-5"><a href="spatial-point-pattern-analysis.html#cb34-5"></a><span class="kw">plot</span>(swp, <span class="dt">pch=</span><span class="dv">20</span>, <span class="dt">cex=</span><span class="fl">0.6</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)  <span class="co"># Add points</span></span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<p>Quadrat test</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="spatial-point-pattern-analysis.html#cb35-1"></a>Q3x3test =<span class="st"> </span><span class="kw">quadrat.test</span>(swp, <span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb35-2"><a href="spatial-point-pattern-analysis.html#cb35-2"></a>Q3x3test</span></code></pre></div>
<pre><code>## 
## 	Chi-squared test of CSR using quadrat counts
## 
## data:  swp
## X2 = 4.6761, df = 8, p-value = 0.4169
## alternative hypothesis: two.sided
## 
## Quadrats: 3 by 3 grid of tiles</code></pre>
</div>
<div id="simulated-csr-pattern" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Simulated CSR Pattern</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="spatial-point-pattern-analysis.html#cb37-1"></a>Q3x3_csr =<span class="st"> </span><span class="kw">quadratcount</span>(pp_csr, <span class="dt">nx=</span><span class="dv">3</span>, <span class="dt">ny=</span><span class="dv">3</span>)</span>
<span id="cb37-2"><a href="spatial-point-pattern-analysis.html#cb37-2"></a><span class="kw">plot</span>(pp_csr)</span>
<span id="cb37-3"><a href="spatial-point-pattern-analysis.html#cb37-3"></a><span class="kw">plot</span>(Q3x3_csr, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Test:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="spatial-point-pattern-analysis.html#cb38-1"></a>Q3x3test_csr =<span class="st"> </span><span class="kw">quadrat.test</span>(pp_csr, <span class="dv">3</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning: Some expected counts are small; chi^2 approximation may be inaccurate</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="spatial-point-pattern-analysis.html#cb40-1"></a>Q3x3test_csr</span></code></pre></div>
<pre><code>## 
## 	Chi-squared test of CSR using quadrat counts
## 
## data:  pp_csr
## X2 = 11.3, df = 8, p-value = 0.3705
## alternative hypothesis: two.sided
## 
## Quadrats: 3 by 3 grid of tiles</code></pre>
</div>
<div id="simulated-cluster-pattern" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Simulated Cluster Pattern</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="spatial-point-pattern-analysis.html#cb42-1"></a>Q3x3_cluster =<span class="st"> </span><span class="kw">quadratcount</span>(pp_cluster, <span class="dt">nx=</span><span class="dv">3</span>, <span class="dt">ny=</span><span class="dv">3</span>)</span>
<span id="cb42-2"><a href="spatial-point-pattern-analysis.html#cb42-2"></a><span class="kw">plot</span>(pp_cluster)</span>
<span id="cb42-3"><a href="spatial-point-pattern-analysis.html#cb42-3"></a><span class="kw">plot</span>(Q3x3_cluster, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Test:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="spatial-point-pattern-analysis.html#cb43-1"></a>Q3x3test_cluster =<span class="st"> </span><span class="kw">quadrat.test</span>(pp_cluster, <span class="dv">3</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning: Some expected counts are small; chi^2 approximation may be inaccurate</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="spatial-point-pattern-analysis.html#cb45-1"></a>Q3x3test_cluster</span></code></pre></div>
<pre><code>## 
## 	Chi-squared test of CSR using quadrat counts
## 
## data:  pp_cluster
## X2 = 48.65, df = 8, p-value = 1.484e-07
## alternative hypothesis: two.sided
## 
## Quadrats: 3 by 3 grid of tiles</code></pre>
</div>
<div id="simulated-regular-pattern" class="section level3">
<h3><span class="header-section-number">2.4.4</span> Simulated Regular Pattern</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="spatial-point-pattern-analysis.html#cb47-1"></a>Q3x3_regular =<span class="st"> </span><span class="kw">quadratcount</span>(pp_regular, <span class="dt">nx=</span><span class="dv">4</span>, <span class="dt">ny=</span><span class="dv">4</span>)</span>
<span id="cb47-2"><a href="spatial-point-pattern-analysis.html#cb47-2"></a><span class="kw">plot</span>(pp_regular)</span>
<span id="cb47-3"><a href="spatial-point-pattern-analysis.html#cb47-3"></a><span class="kw">plot</span>(Q3x3_regular, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Test:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="spatial-point-pattern-analysis.html#cb48-1"></a>Q3x3test_regular =<span class="st"> </span><span class="kw">quadrat.test</span>(pp_regular, <span class="dv">3</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Warning: Some expected counts are small; chi^2 approximation may be inaccurate</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="spatial-point-pattern-analysis.html#cb50-1"></a>Q3x3test_regular</span></code></pre></div>
<pre><code>## 
## 	Chi-squared test of CSR using quadrat counts
## 
## data:  pp_regular
## X2 = 4.55, df = 8, p-value = 0.3912
## alternative hypothesis: two.sided
## 
## Quadrats: 3 by 3 grid of tiles</code></pre>
</div>
</div>
<div id="kernel-density-smoothing" class="section level2">
<h2><span class="header-section-number">2.5</span> Kernel Density Smoothing</h2>
<div id="csr-pattern" class="section level3">
<h3><span class="header-section-number">2.5.1</span> CSR Pattern</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="spatial-point-pattern-analysis.html#cb52-1"></a>den &lt;-<span class="st"> </span><span class="kw">density</span>(pp_csr, <span class="dt">sigma =</span> <span class="fl">.1</span>)</span>
<span id="cb52-2"><a href="spatial-point-pattern-analysis.html#cb52-2"></a><span class="kw">plot</span>(den, <span class="dt">main =</span> <span class="st">&quot;CSR&quot;</span>)</span>
<span id="cb52-3"><a href="spatial-point-pattern-analysis.html#cb52-3"></a><span class="kw">plot</span>(pp_csr, <span class="dt">add=</span><span class="ot">TRUE</span>)</span>
<span id="cb52-4"><a href="spatial-point-pattern-analysis.html#cb52-4"></a><span class="kw">contour</span>(den, <span class="dt">add =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="regular-pattern" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Regular Pattern</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="spatial-point-pattern-analysis.html#cb53-1"></a>den &lt;-<span class="st"> </span><span class="kw">density</span>(pp_regular)</span>
<span id="cb53-2"><a href="spatial-point-pattern-analysis.html#cb53-2"></a><span class="kw">plot</span>(den, <span class="dt">main =</span> <span class="st">&quot;Regular&quot;</span>)</span>
<span id="cb53-3"><a href="spatial-point-pattern-analysis.html#cb53-3"></a><span class="kw">plot</span>(pp_regular, <span class="dt">add=</span><span class="ot">TRUE</span>)</span>
<span id="cb53-4"><a href="spatial-point-pattern-analysis.html#cb53-4"></a><span class="kw">contour</span>(den, <span class="dt">add=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="cluster-pattern" class="section level3">
<h3><span class="header-section-number">2.5.3</span> Cluster Pattern</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="spatial-point-pattern-analysis.html#cb54-1"></a>den &lt;-<span class="st"> </span><span class="kw">density</span>(pp_cluster)</span>
<span id="cb54-2"><a href="spatial-point-pattern-analysis.html#cb54-2"></a><span class="kw">plot</span>(den, <span class="dt">main =</span> <span class="st">&quot;Cluster&quot;</span>)</span>
<span id="cb54-3"><a href="spatial-point-pattern-analysis.html#cb54-3"></a><span class="kw">plot</span>(pp_cluster, <span class="dt">add=</span><span class="ot">TRUE</span>)</span>
<span id="cb54-4"><a href="spatial-point-pattern-analysis.html#cb54-4"></a><span class="kw">contour</span>(den, <span class="dt">add=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
</div>
<div id="kernel-smoothing-with-a-covariate" class="section level2">
<h2><span class="header-section-number">2.6</span> Kernel Smoothing with a Covariate</h2>
<div id="tropical-rain-forest-trees-dataset" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Tropical rain forest trees dataset</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="spatial-point-pattern-analysis.html#cb55-1"></a><span class="kw">data</span>(<span class="st">&quot;bei&quot;</span>)</span></code></pre></div>
<p>Assign the elevation covariate to a variable elev by typing</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="spatial-point-pattern-analysis.html#cb56-1"></a>elev &lt;-<span class="st"> </span>bei.extra<span class="op">$</span>elev</span></code></pre></div>
<p>Plot the trees on top of an image of the elevation covariate.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="spatial-point-pattern-analysis.html#cb57-1"></a><span class="kw">plot</span>(elev, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb57-2"><a href="spatial-point-pattern-analysis.html#cb57-2"></a><span class="kw">plot</span>(bei, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">0.3</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cols =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>For the tropical rainforest data bei, it might be useful to split the study region into several
sub-regions according to the terrain elevation:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="spatial-point-pattern-analysis.html#cb58-1"></a>b &lt;-<span class="st"> </span><span class="kw">quantile</span>(elev, <span class="dt">probs=</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">4</span>)<span class="op">/</span><span class="dv">4</span>, <span class="dt">type=</span><span class="dv">2</span>)</span>
<span id="cb58-2"><a href="spatial-point-pattern-analysis.html#cb58-2"></a></span>
<span id="cb58-3"><a href="spatial-point-pattern-analysis.html#cb58-3"></a>Zcut &lt;-<span class="st"> </span><span class="kw">cut</span>(elev, <span class="dt">breaks=</span>b, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med-Low&quot;</span>, <span class="st">&quot;Med-High&quot;</span>, <span class="st">&quot;High&quot;</span>))</span>
<span id="cb58-4"><a href="spatial-point-pattern-analysis.html#cb58-4"></a><span class="kw">textureplot</span>(Zcut, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Convert the image from above to a tesselation, count the number of points in each region using quadratcount, and plot the quadrat counts.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="spatial-point-pattern-analysis.html#cb59-1"></a>V &lt;-<span class="st"> </span><span class="kw">tess</span>(<span class="dt">image=</span>Zcut)</span>
<span id="cb59-2"><a href="spatial-point-pattern-analysis.html#cb59-2"></a>qc &lt;-<span class="st"> </span><span class="kw">quadratcount</span>(bei, <span class="dt">tess =</span> V)</span>
<span id="cb59-3"><a href="spatial-point-pattern-analysis.html#cb59-3"></a>qc</span></code></pre></div>
<pre><code>## tile
##      Low  Med-Low Med-High     High 
##      714      883     1344      663</code></pre>
<p>The output shows the number of trees in each region. Since the four regions have equal area, the counts should be approximately equal if there is a uniform density of trees. Obviously they are not equal; there appears to be a strong preference for higher elevations (dropping off for the highest elevations).</p>
<p>Estimate the intensity in each of the four regions.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="spatial-point-pattern-analysis.html#cb61-1"></a><span class="kw">intensity</span>(qc)</span></code></pre></div>
<pre><code>## tile
##         Low     Med-Low    Med-High        High 
## 0.005623154 0.006960978 0.010593103 0.005228707</code></pre>
<p>Assume that the intensity of trees is a function ((u) = (e(u))) where (e(u)) is the terrain elevation at location u.</p>
<p>Compute a nonparametric estimate of the function () and plot it by</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="spatial-point-pattern-analysis.html#cb63-1"></a>rh &lt;-<span class="st"> </span><span class="kw">rhohat</span>(bei, elev)</span>
<span id="cb63-2"><a href="spatial-point-pattern-analysis.html#cb63-2"></a><span class="kw">plot</span>(rh)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>Compute the predicted intensity based on this estimate of ().</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="spatial-point-pattern-analysis.html#cb64-1"></a>predictedrho &lt;-<span class="st"> </span><span class="kw">predict</span>(rh)</span>
<span id="cb64-2"><a href="spatial-point-pattern-analysis.html#cb64-2"></a><span class="kw">plot</span>(predictedrho, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb64-3"><a href="spatial-point-pattern-analysis.html#cb64-3"></a><span class="kw">plot</span>(bei, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cols =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">cex =</span> <span class="fl">.2</span>, <span class="dt">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>Compute a non-parametric estimate by kernel smoothing and compare with the predicted intensity above.</p>
<p>The kernel density estimate of the points is computed and plotted with the following code:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="spatial-point-pattern-analysis.html#cb65-1"></a>kerneldensity &lt;-<span class="st"> </span><span class="kw">density</span>(bei, <span class="dt">sigma =</span> bw.scott)</span>
<span id="cb65-2"><a href="spatial-point-pattern-analysis.html#cb65-2"></a><span class="kw">plot</span>(kerneldensity, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb65-3"><a href="spatial-point-pattern-analysis.html#cb65-3"></a><span class="kw">plot</span>(kerneldensity, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">cols =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">cex =</span> <span class="fl">.2</span>, <span class="dt">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>Compare the two</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="spatial-point-pattern-analysis.html#cb66-1"></a><span class="kw">pairs</span>(predictedrho, kerneldensity)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="spatial-point-pattern-analysis.html#cb67-1"></a><span class="kw">plot</span>(<span class="kw">eval.im</span>(kerneldensity<span class="op">-</span>predictedrho))</span></code></pre></div>
<pre><code>## Warning: the images &#39;kerneldensity&#39; and &#39;predictedrho&#39; were not compatible</code></pre>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-35-2.png" width="672" /></p>
<p>Which seems to be quite different form the predicted intensity.</p>
</div>
</div>
<div id="distance-measures-and-tests" class="section level2">
<h2><span class="header-section-number">2.7</span> Distance Measures and Tests</h2>
<div id="e2e-distances" class="section level3">
<h3><span class="header-section-number">2.7.1</span> e2e Distances</h3>
<div id="swp-dataset-1" class="section level4">
<h4><span class="header-section-number">2.7.1.1</span> swp dataset</h4>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="spatial-point-pattern-analysis.html#cb69-1"></a>PD =<span class="st"> </span><span class="kw">pairdist</span>(swp)</span>
<span id="cb69-2"><a href="spatial-point-pattern-analysis.html#cb69-2"></a><span class="kw">class</span>(PD)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="spatial-point-pattern-analysis.html#cb71-1"></a>dm &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(PD)</span>
<span id="cb71-2"><a href="spatial-point-pattern-analysis.html#cb71-2"></a>dm[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##          [,1]     [,2]     [,3]     [,4]     [,5]
## [1,] 0.000000 2.700000 3.701351 1.503330 5.433231
## [2,] 2.700000 0.000000 1.004988 1.204159 2.765863
## [3,] 3.701351 1.004988 0.000000 2.200000 1.772005
## [4,] 1.503330 1.204159 2.200000 0.000000 3.931921
## [5,] 5.433231 2.765863 1.772005 3.931921 0.000000</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="spatial-point-pattern-analysis.html#cb73-1"></a><span class="kw">diag</span>(dm) &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb73-2"><a href="spatial-point-pattern-analysis.html#cb73-2"></a><span class="co">#dm[1:5, 1:5]</span></span>
<span id="cb73-3"><a href="spatial-point-pattern-analysis.html#cb73-3"></a>wdmin &lt;-<span class="st"> </span><span class="kw">apply</span>(dm, <span class="dv">1</span>, which.min)</span>
<span id="cb73-4"><a href="spatial-point-pattern-analysis.html#cb73-4"></a></span>
<span id="cb73-5"><a href="spatial-point-pattern-analysis.html#cb73-5"></a>dmin &lt;-<span class="st"> </span><span class="kw">apply</span>(dm, <span class="dv">1</span>, min, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb73-6"><a href="spatial-point-pattern-analysis.html#cb73-6"></a><span class="kw">head</span>(dmin)</span></code></pre></div>
<pre><code>## [1] 1.5033296 0.8544004 1.0049876 0.9055385 1.0770330 0.8544004</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="spatial-point-pattern-analysis.html#cb75-1"></a><span class="co"># which is the same as nndist e2e=nndist(swp)</span></span>
<span id="cb75-2"><a href="spatial-point-pattern-analysis.html#cb75-2"></a></span>
<span id="cb75-3"><a href="spatial-point-pattern-analysis.html#cb75-3"></a>dmin =<span class="st"> </span><span class="kw">nndist</span>(swp)</span>
<span id="cb75-4"><a href="spatial-point-pattern-analysis.html#cb75-4"></a></span>
<span id="cb75-5"><a href="spatial-point-pattern-analysis.html#cb75-5"></a><span class="kw">plot</span>(swp)</span>
<span id="cb75-6"><a href="spatial-point-pattern-analysis.html#cb75-6"></a>xy =<span class="st"> </span><span class="kw">cbind</span>(swp<span class="op">$</span>x, swp<span class="op">$</span>y)</span>
<span id="cb75-7"><a href="spatial-point-pattern-analysis.html#cb75-7"></a></span>
<span id="cb75-8"><a href="spatial-point-pattern-analysis.html#cb75-8"></a>ord &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">order</span>(dmin))</span>
<span id="cb75-9"><a href="spatial-point-pattern-analysis.html#cb75-9"></a>far25 &lt;-<span class="st"> </span>ord[<span class="dv">1</span><span class="op">:</span><span class="dv">71</span>]</span>
<span id="cb75-10"><a href="spatial-point-pattern-analysis.html#cb75-10"></a>neighbors &lt;-<span class="st"> </span>wdmin[far25]</span>
<span id="cb75-11"><a href="spatial-point-pattern-analysis.html#cb75-11"></a><span class="kw">points</span>(xy[far25, ], <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb75-12"><a href="spatial-point-pattern-analysis.html#cb75-12"></a><span class="kw">points</span>(xy[neighbors, ], <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb75-13"><a href="spatial-point-pattern-analysis.html#cb75-13"></a><span class="co"># drawing the lines, easiest via a loop</span></span>
<span id="cb75-14"><a href="spatial-point-pattern-analysis.html#cb75-14"></a><span class="cf">for</span> (i <span class="cf">in</span> far25) {</span>
<span id="cb75-15"><a href="spatial-point-pattern-analysis.html#cb75-15"></a>    <span class="kw">lines</span>(<span class="kw">rbind</span>(xy[i, ], xy[wdmin[i], ]), <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb75-16"><a href="spatial-point-pattern-analysis.html#cb75-16"></a>}</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
<div id="simulated-csr-pattern-1" class="section level4">
<h4><span class="header-section-number">2.7.1.2</span> Simulated CSR Pattern</h4>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="spatial-point-pattern-analysis.html#cb76-1"></a>e2e_csr =<span class="st"> </span><span class="kw">nndist</span>(pp_csr)</span>
<span id="cb76-2"><a href="spatial-point-pattern-analysis.html#cb76-2"></a>e2e_csr</span></code></pre></div>
<pre><code>##  [1] 0.11056220 0.05419105 0.08163249 0.05574520 0.19907565 0.03191166
##  [7] 0.10456756 0.15049858 0.16325765 0.02841510 0.05044346 0.05419105
## [13] 0.10456756 0.07525211 0.02471890 0.08651227 0.03700818 0.06471165
## [19] 0.12663659 0.08163249 0.06471165 0.07525211 0.14362670 0.03195288
## [25] 0.09669706 0.03195288 0.09731910 0.04284774 0.11297958 0.03191166
## [31] 0.13454666 0.02841510 0.02471890 0.06711512 0.10924574 0.04269836
## [37] 0.09947882 0.03815278 0.14362670 0.10235020</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="spatial-point-pattern-analysis.html#cb78-1"></a>PD =<span class="st"> </span><span class="kw">pairdist</span>(pp_csr)</span>
<span id="cb78-2"><a href="spatial-point-pattern-analysis.html#cb78-2"></a><span class="kw">class</span>(PD)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="spatial-point-pattern-analysis.html#cb80-1"></a>dm &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(PD)</span>
<span id="cb80-2"><a href="spatial-point-pattern-analysis.html#cb80-2"></a>dm[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]      [,4]      [,5]
## [1,] 0.0000000 0.2930205 0.5163115 0.2844957 0.7955061
## [2,] 0.2930205 0.0000000 0.5975953 0.4633681 0.8993362
## [3,] 0.5163115 0.5975953 0.0000000 0.2546708 0.3017974
## [4,] 0.2844957 0.4633681 0.2546708 0.0000000 0.5130861
## [5,] 0.7955061 0.8993362 0.3017974 0.5130861 0.0000000</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="spatial-point-pattern-analysis.html#cb82-1"></a><span class="kw">diag</span>(dm) &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb82-2"><a href="spatial-point-pattern-analysis.html#cb82-2"></a><span class="co">#dm[1:5, 1:5]</span></span>
<span id="cb82-3"><a href="spatial-point-pattern-analysis.html#cb82-3"></a>wdmin &lt;-<span class="st"> </span><span class="kw">apply</span>(dm, <span class="dv">1</span>, which.min)</span>
<span id="cb82-4"><a href="spatial-point-pattern-analysis.html#cb82-4"></a></span>
<span id="cb82-5"><a href="spatial-point-pattern-analysis.html#cb82-5"></a>dmin &lt;-<span class="st"> </span><span class="kw">apply</span>(dm, <span class="dv">1</span>, min, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb82-6"><a href="spatial-point-pattern-analysis.html#cb82-6"></a><span class="kw">head</span>(dmin)</span></code></pre></div>
<pre><code>## [1] 0.11056220 0.05419105 0.08163249 0.05574520 0.19907565 0.03191166</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="spatial-point-pattern-analysis.html#cb84-1"></a><span class="co"># which is the same as nndist e2e=nndist(swp)</span></span>
<span id="cb84-2"><a href="spatial-point-pattern-analysis.html#cb84-2"></a></span>
<span id="cb84-3"><a href="spatial-point-pattern-analysis.html#cb84-3"></a>dmin =<span class="st"> </span><span class="kw">nndist</span>(pp_csr)</span>
<span id="cb84-4"><a href="spatial-point-pattern-analysis.html#cb84-4"></a></span>
<span id="cb84-5"><a href="spatial-point-pattern-analysis.html#cb84-5"></a><span class="kw">plot</span>(pp_csr)</span>
<span id="cb84-6"><a href="spatial-point-pattern-analysis.html#cb84-6"></a>xy =<span class="st"> </span><span class="kw">cbind</span>(pp_csr<span class="op">$</span>x, pp_csr<span class="op">$</span>y)</span>
<span id="cb84-7"><a href="spatial-point-pattern-analysis.html#cb84-7"></a></span>
<span id="cb84-8"><a href="spatial-point-pattern-analysis.html#cb84-8"></a>ord &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">order</span>(dmin))</span>
<span id="cb84-9"><a href="spatial-point-pattern-analysis.html#cb84-9"></a>far25 &lt;-<span class="st"> </span>ord[<span class="dv">1</span><span class="op">:</span><span class="dv">40</span>]</span>
<span id="cb84-10"><a href="spatial-point-pattern-analysis.html#cb84-10"></a>neighbors &lt;-<span class="st"> </span>wdmin[far25]</span>
<span id="cb84-11"><a href="spatial-point-pattern-analysis.html#cb84-11"></a><span class="kw">points</span>(xy[far25, ], <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb84-12"><a href="spatial-point-pattern-analysis.html#cb84-12"></a><span class="kw">points</span>(xy[neighbors, ], <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb84-13"><a href="spatial-point-pattern-analysis.html#cb84-13"></a><span class="co"># drawing the lines, easiest via a loop</span></span>
<span id="cb84-14"><a href="spatial-point-pattern-analysis.html#cb84-14"></a><span class="cf">for</span> (i <span class="cf">in</span> far25) {</span>
<span id="cb84-15"><a href="spatial-point-pattern-analysis.html#cb84-15"></a>    <span class="kw">lines</span>(<span class="kw">rbind</span>(xy[i, ], xy[wdmin[i], ]), <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb84-16"><a href="spatial-point-pattern-analysis.html#cb84-16"></a>}</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="simulated-cluster-pattern-1" class="section level4">
<h4><span class="header-section-number">2.7.1.3</span> Simulated Cluster Pattern</h4>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="spatial-point-pattern-analysis.html#cb85-1"></a>e2e_cluster =<span class="st"> </span><span class="kw">nndist</span>(pp_cluster)</span>
<span id="cb85-2"><a href="spatial-point-pattern-analysis.html#cb85-2"></a>e2e_cluster</span></code></pre></div>
<pre><code>##  [1] 0.01854666 0.03502091 0.01854666 0.04969353 0.03502091 0.03390187
##  [7] 0.01268286 0.05624330 0.01268286 0.03830134 0.04275255 0.02983313
## [13] 0.04275255 0.02983313 0.03774271 0.03774271 0.03391843 0.01376367
## [19] 0.01376367 0.03500058 0.08344093 0.06403124 0.05422191 0.08344093
## [25] 0.03500058 0.08988091 0.04304986 0.07202173 0.04586212 0.02906394
## [31] 0.08760076 0.11053898 0.04586212 0.02906394 0.05896243 0.07149045
## [37] 0.04361429 0.04361429 0.05745563 0.07483198</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="spatial-point-pattern-analysis.html#cb87-1"></a>PD_cluster =<span class="st"> </span><span class="kw">pairdist</span>(pp_cluster)</span>
<span id="cb87-2"><a href="spatial-point-pattern-analysis.html#cb87-2"></a><span class="kw">class</span>(PD_cluster)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="spatial-point-pattern-analysis.html#cb89-1"></a>dm_cluster &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(PD_cluster)</span>
<span id="cb89-2"><a href="spatial-point-pattern-analysis.html#cb89-2"></a>dm_cluster[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]       [,4]       [,5]
## [1,] 0.00000000 0.09345138 0.01854666 0.04969353 0.07093497
## [2,] 0.09345138 0.00000000 0.08597921 0.13688899 0.03502091
## [3,] 0.01854666 0.08597921 0.00000000 0.05097721 0.05847323
## [4,] 0.04969353 0.13688899 0.05097721 0.00000000 0.10757315
## [5,] 0.07093497 0.03502091 0.05847323 0.10757315 0.00000000</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="spatial-point-pattern-analysis.html#cb91-1"></a><span class="kw">diag</span>(dm_cluster) &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb91-2"><a href="spatial-point-pattern-analysis.html#cb91-2"></a>wdmin_cluster &lt;-<span class="st"> </span><span class="kw">apply</span>(dm_cluster, <span class="dv">1</span>, which.min)</span>
<span id="cb91-3"><a href="spatial-point-pattern-analysis.html#cb91-3"></a></span>
<span id="cb91-4"><a href="spatial-point-pattern-analysis.html#cb91-4"></a>dmin_cluster &lt;-<span class="st"> </span><span class="kw">apply</span>(dm_cluster, <span class="dv">1</span>, min, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb91-5"><a href="spatial-point-pattern-analysis.html#cb91-5"></a><span class="kw">head</span>(dmin<span class="op">-</span>cluster)</span></code></pre></div>
<pre><code>##              X          Y
## 1  0.080388175 -0.4397788
## 2  0.018557146 -0.5894417
## 3  0.034750612 -0.4767600
## 4 -0.001070259 -0.4526473
## 5  0.141971489 -0.4168896
## 6 -0.048015500 -0.5340536</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="spatial-point-pattern-analysis.html#cb93-1"></a><span class="co"># which is the same as nndist e2e=nndist(swp)</span></span>
<span id="cb93-2"><a href="spatial-point-pattern-analysis.html#cb93-2"></a></span>
<span id="cb93-3"><a href="spatial-point-pattern-analysis.html#cb93-3"></a>dmin_cluster =<span class="st"> </span><span class="kw">nndist</span>(pp_cluster)</span>
<span id="cb93-4"><a href="spatial-point-pattern-analysis.html#cb93-4"></a></span>
<span id="cb93-5"><a href="spatial-point-pattern-analysis.html#cb93-5"></a><span class="kw">plot</span>(pp_cluster)</span>
<span id="cb93-6"><a href="spatial-point-pattern-analysis.html#cb93-6"></a>xy_cluster =<span class="st"> </span><span class="kw">cbind</span>(pp_cluster<span class="op">$</span>x, pp_cluster<span class="op">$</span>y)</span>
<span id="cb93-7"><a href="spatial-point-pattern-analysis.html#cb93-7"></a></span>
<span id="cb93-8"><a href="spatial-point-pattern-analysis.html#cb93-8"></a>ord &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">order</span>(dmin_cluster))</span>
<span id="cb93-9"><a href="spatial-point-pattern-analysis.html#cb93-9"></a>far25 &lt;-<span class="st"> </span>ord[<span class="dv">1</span><span class="op">:</span><span class="dv">40</span>]</span>
<span id="cb93-10"><a href="spatial-point-pattern-analysis.html#cb93-10"></a>neighbors &lt;-<span class="st"> </span>wdmin_cluster[far25]</span>
<span id="cb93-11"><a href="spatial-point-pattern-analysis.html#cb93-11"></a><span class="kw">points</span>(xy_cluster[far25, ], <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb93-12"><a href="spatial-point-pattern-analysis.html#cb93-12"></a><span class="kw">points</span>(xy_cluster[neighbors, ], <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb93-13"><a href="spatial-point-pattern-analysis.html#cb93-13"></a><span class="co"># drawing the lines, easiest via a loop</span></span>
<span id="cb93-14"><a href="spatial-point-pattern-analysis.html#cb93-14"></a><span class="cf">for</span> (i <span class="cf">in</span> far25) {</span>
<span id="cb93-15"><a href="spatial-point-pattern-analysis.html#cb93-15"></a>    <span class="kw">lines</span>(<span class="kw">rbind</span>(xy_cluster[i, ], xy_cluster[wdmin_cluster[i], ]), <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb93-16"><a href="spatial-point-pattern-analysis.html#cb93-16"></a>}</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="simulated-regular-pattern-1" class="section level4">
<h4><span class="header-section-number">2.7.1.4</span> Simulated Regular Pattern</h4>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="spatial-point-pattern-analysis.html#cb94-1"></a>e2e_regular =<span class="st"> </span><span class="kw">nndist</span>(pp_regular)</span>
<span id="cb94-2"><a href="spatial-point-pattern-analysis.html#cb94-2"></a>e2e_regular</span></code></pre></div>
<pre><code>##  [1] 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111
##  [8] 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111
## [15] 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111
## [22] 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111
## [29] 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111
## [36] 0.1111111 0.1111111 0.1111111 0.1111111 0.1111111</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="spatial-point-pattern-analysis.html#cb96-1"></a>PD_regular =<span class="st"> </span><span class="kw">pairdist</span>(pp_regular)</span>
<span id="cb96-2"><a href="spatial-point-pattern-analysis.html#cb96-2"></a><span class="kw">class</span>(PD_regular)</span></code></pre></div>
<pre><code>## [1] &quot;matrix&quot; &quot;array&quot;</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="spatial-point-pattern-analysis.html#cb98-1"></a>dm_regular &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(PD_regular)</span>
<span id="cb98-2"><a href="spatial-point-pattern-analysis.html#cb98-2"></a>dm_regular[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]      [,4]      [,5]
## [1,] 0.0000000 0.1666667 0.3333333 0.5000000 0.6666667
## [2,] 0.1666667 0.0000000 0.1666667 0.3333333 0.5000000
## [3,] 0.3333333 0.1666667 0.0000000 0.1666667 0.3333333
## [4,] 0.5000000 0.3333333 0.1666667 0.0000000 0.1666667
## [5,] 0.6666667 0.5000000 0.3333333 0.1666667 0.0000000</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="spatial-point-pattern-analysis.html#cb100-1"></a><span class="kw">diag</span>(dm_regular) &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb100-2"><a href="spatial-point-pattern-analysis.html#cb100-2"></a>wdmin_regular &lt;-<span class="st"> </span><span class="kw">apply</span>(dm_regular, <span class="dv">1</span>, which.min)</span>
<span id="cb100-3"><a href="spatial-point-pattern-analysis.html#cb100-3"></a></span>
<span id="cb100-4"><a href="spatial-point-pattern-analysis.html#cb100-4"></a>dmin_regular &lt;-<span class="st"> </span><span class="kw">apply</span>(dm_regular, <span class="dv">1</span>, min, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</span>
<span id="cb100-5"><a href="spatial-point-pattern-analysis.html#cb100-5"></a><span class="kw">head</span>(dmin<span class="op">-</span>regular)</span></code></pre></div>
<pre><code>##             X             Y
## 1 -0.05610447 -0.0005489143
## 2 -0.27914228 -0.0569200607
## 3 -0.41836751 -0.0294786165
## 4 -0.61092147 -0.0553659112
## 5 -0.63425768  0.0879645408
## 6 -0.13475501 -0.1903105666</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="spatial-point-pattern-analysis.html#cb102-1"></a><span class="co"># which is the same as nndist e2e=nndist(swp)</span></span>
<span id="cb102-2"><a href="spatial-point-pattern-analysis.html#cb102-2"></a></span>
<span id="cb102-3"><a href="spatial-point-pattern-analysis.html#cb102-3"></a>dmin_regular =<span class="st"> </span><span class="kw">nndist</span>(pp_regular)</span>
<span id="cb102-4"><a href="spatial-point-pattern-analysis.html#cb102-4"></a></span>
<span id="cb102-5"><a href="spatial-point-pattern-analysis.html#cb102-5"></a><span class="kw">plot</span>(pp_regular)</span>
<span id="cb102-6"><a href="spatial-point-pattern-analysis.html#cb102-6"></a>xy_regular =<span class="st"> </span><span class="kw">cbind</span>(pp_regular<span class="op">$</span>x, pp_regular<span class="op">$</span>y)</span>
<span id="cb102-7"><a href="spatial-point-pattern-analysis.html#cb102-7"></a></span>
<span id="cb102-8"><a href="spatial-point-pattern-analysis.html#cb102-8"></a>ord &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">order</span>(dmin_regular))</span>
<span id="cb102-9"><a href="spatial-point-pattern-analysis.html#cb102-9"></a>far25 &lt;-<span class="st"> </span>ord[<span class="dv">1</span><span class="op">:</span><span class="dv">40</span>]</span>
<span id="cb102-10"><a href="spatial-point-pattern-analysis.html#cb102-10"></a>neighbors &lt;-<span class="st"> </span>wdmin_regular[far25]</span>
<span id="cb102-11"><a href="spatial-point-pattern-analysis.html#cb102-11"></a><span class="kw">points</span>(xy_regular[far25, ], <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb102-12"><a href="spatial-point-pattern-analysis.html#cb102-12"></a><span class="kw">points</span>(xy_regular[neighbors, ], <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb102-13"><a href="spatial-point-pattern-analysis.html#cb102-13"></a><span class="co"># drawing the lines, easiest via a loop</span></span>
<span id="cb102-14"><a href="spatial-point-pattern-analysis.html#cb102-14"></a><span class="cf">for</span> (i <span class="cf">in</span> far25) {</span>
<span id="cb102-15"><a href="spatial-point-pattern-analysis.html#cb102-15"></a>    <span class="kw">lines</span>(<span class="kw">rbind</span>(xy_regular[i, ], xy_regular[wdmin_regular[i], ]), <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb102-16"><a href="spatial-point-pattern-analysis.html#cb102-16"></a>}</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
</div>
</div>
<div id="p2e-distances" class="section level3">
<h3><span class="header-section-number">2.7.2</span> p2e Distances</h3>
<p>Generate Random points</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="spatial-point-pattern-analysis.html#cb103-1"></a><span class="kw">set.seed</span>(<span class="dv">23</span>)</span>
<span id="cb103-2"><a href="spatial-point-pattern-analysis.html#cb103-2"></a>randompoints =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">60</span>),<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb103-3"><a href="spatial-point-pattern-analysis.html#cb103-3"></a><span class="co">#randompoints = matrix(runif(250),ncol=2)</span></span></code></pre></div>
<div id="csr-pattern-1" class="section level4">
<h4><span class="header-section-number">2.7.2.1</span> CSR Pattern</h4>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="spatial-point-pattern-analysis.html#cb104-1"></a><span class="kw">plot</span>(pp_csr)</span>
<span id="cb104-2"><a href="spatial-point-pattern-analysis.html#cb104-2"></a><span class="kw">points</span>(randompoints, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">pch=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="spatial-point-pattern-analysis.html#cb105-1"></a>p2e_distances_csr =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb105-2"><a href="spatial-point-pattern-analysis.html#cb105-2"></a>mins_csr =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb105-3"><a href="spatial-point-pattern-analysis.html#cb105-3"></a>xy =<span class="st"> </span><span class="kw">cbind</span>(pp_csr<span class="op">$</span>x, pp_csr<span class="op">$</span>y)</span>
<span id="cb105-4"><a href="spatial-point-pattern-analysis.html#cb105-4"></a></span>
<span id="cb105-5"><a href="spatial-point-pattern-analysis.html#cb105-5"></a></span>
<span id="cb105-6"><a href="spatial-point-pattern-analysis.html#cb105-6"></a><span class="co"># sqrt((xy[2,1]-randompoints[1,1])^2+(xy[2,2]-randompoints[1,2])^2)</span></span>
<span id="cb105-7"><a href="spatial-point-pattern-analysis.html#cb105-7"></a><span class="co"># sqrt((xy[1,1]-randompoints[2,1])^2+(xy[1,2]-randompoints[2,2])^2)</span></span>
<span id="cb105-8"><a href="spatial-point-pattern-analysis.html#cb105-8"></a></span>
<span id="cb105-9"><a href="spatial-point-pattern-analysis.html#cb105-9"></a></span>
<span id="cb105-10"><a href="spatial-point-pattern-analysis.html#cb105-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(randompoints)[<span class="dv">1</span>]){</span>
<span id="cb105-11"><a href="spatial-point-pattern-analysis.html#cb105-11"></a>dist1 =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">pairdist</span>(<span class="kw">rbind</span>(randompoints[i,],xy)),<span class="dv">41</span>)</span>
<span id="cb105-12"><a href="spatial-point-pattern-analysis.html#cb105-12"></a></span>
<span id="cb105-13"><a href="spatial-point-pattern-analysis.html#cb105-13"></a>p2e_distances_csr =<span class="st"> </span><span class="kw">c</span>(p2e_distances_csr,<span class="kw">min</span>(dist1[<span class="dv">2</span><span class="op">:</span><span class="dv">41</span>,<span class="dv">1</span>]))</span>
<span id="cb105-14"><a href="spatial-point-pattern-analysis.html#cb105-14"></a>mins_csr =<span class="st"> </span><span class="kw">c</span>(mins_csr,<span class="kw">which.min</span>(dist1[<span class="dv">2</span><span class="op">:</span><span class="dv">41</span>,<span class="dv">1</span>]))</span>
<span id="cb105-15"><a href="spatial-point-pattern-analysis.html#cb105-15"></a>}</span>
<span id="cb105-16"><a href="spatial-point-pattern-analysis.html#cb105-16"></a></span>
<span id="cb105-17"><a href="spatial-point-pattern-analysis.html#cb105-17"></a></span>
<span id="cb105-18"><a href="spatial-point-pattern-analysis.html#cb105-18"></a><span class="kw">plot</span>(pp_csr)</span>
<span id="cb105-19"><a href="spatial-point-pattern-analysis.html#cb105-19"></a>ord &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">order</span>(p2e_distances_csr))</span>
<span id="cb105-20"><a href="spatial-point-pattern-analysis.html#cb105-20"></a>far25 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(randompoints)[<span class="dv">1</span>]</span>
<span id="cb105-21"><a href="spatial-point-pattern-analysis.html#cb105-21"></a>neighbors &lt;-<span class="st"> </span>mins_csr</span>
<span id="cb105-22"><a href="spatial-point-pattern-analysis.html#cb105-22"></a><span class="kw">points</span>(randompoints, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>, <span class="dt">pch=</span><span class="dv">4</span>)</span>
<span id="cb105-23"><a href="spatial-point-pattern-analysis.html#cb105-23"></a><span class="kw">points</span>(xy[mins_csr, ], <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb105-24"><a href="spatial-point-pattern-analysis.html#cb105-24"></a><span class="co"># drawing the lines, easiest via a loop</span></span>
<span id="cb105-25"><a href="spatial-point-pattern-analysis.html#cb105-25"></a><span class="cf">for</span> (i <span class="cf">in</span> far25) {</span>
<span id="cb105-26"><a href="spatial-point-pattern-analysis.html#cb105-26"></a>  <span class="kw">lines</span>(<span class="kw">rbind</span>(xy[mins_csr[i], ], randompoints[i, ]), <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb105-27"><a href="spatial-point-pattern-analysis.html#cb105-27"></a>}</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
<div id="cluster-pattern-1" class="section level4">
<h4><span class="header-section-number">2.7.2.2</span> Cluster Pattern</h4>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="spatial-point-pattern-analysis.html#cb106-1"></a><span class="kw">plot</span>(pp_cluster)</span>
<span id="cb106-2"><a href="spatial-point-pattern-analysis.html#cb106-2"></a><span class="kw">points</span>(randompoints, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">pch=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="spatial-point-pattern-analysis.html#cb107-1"></a>p2e_distances_cluster =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb107-2"><a href="spatial-point-pattern-analysis.html#cb107-2"></a>mins_cluster =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb107-3"><a href="spatial-point-pattern-analysis.html#cb107-3"></a>xy_cluster =<span class="st"> </span><span class="kw">cbind</span>(pp_cluster<span class="op">$</span>x, pp_cluster<span class="op">$</span>y)</span>
<span id="cb107-4"><a href="spatial-point-pattern-analysis.html#cb107-4"></a></span>
<span id="cb107-5"><a href="spatial-point-pattern-analysis.html#cb107-5"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(randompoints)[<span class="dv">1</span>]){</span>
<span id="cb107-6"><a href="spatial-point-pattern-analysis.html#cb107-6"></a>dist1 =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">pairdist</span>(<span class="kw">rbind</span>(randompoints[i,],xy_cluster)),<span class="dv">41</span>)</span>
<span id="cb107-7"><a href="spatial-point-pattern-analysis.html#cb107-7"></a></span>
<span id="cb107-8"><a href="spatial-point-pattern-analysis.html#cb107-8"></a>p2e_distances_cluster =<span class="st"> </span><span class="kw">c</span>(p2e_distances_cluster,<span class="kw">min</span>(dist1[<span class="dv">2</span><span class="op">:</span><span class="dv">41</span>,<span class="dv">1</span>]))</span>
<span id="cb107-9"><a href="spatial-point-pattern-analysis.html#cb107-9"></a>mins_cluster =<span class="st"> </span><span class="kw">c</span>(mins_cluster,<span class="kw">which.min</span>(dist1[<span class="dv">2</span><span class="op">:</span><span class="dv">41</span>,<span class="dv">1</span>]))</span>
<span id="cb107-10"><a href="spatial-point-pattern-analysis.html#cb107-10"></a>}</span>
<span id="cb107-11"><a href="spatial-point-pattern-analysis.html#cb107-11"></a></span>
<span id="cb107-12"><a href="spatial-point-pattern-analysis.html#cb107-12"></a></span>
<span id="cb107-13"><a href="spatial-point-pattern-analysis.html#cb107-13"></a><span class="kw">plot</span>(pp_cluster)</span>
<span id="cb107-14"><a href="spatial-point-pattern-analysis.html#cb107-14"></a>ord &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">order</span>(p2e_distances_cluster))</span>
<span id="cb107-15"><a href="spatial-point-pattern-analysis.html#cb107-15"></a>far25 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(randompoints)[<span class="dv">1</span>]</span>
<span id="cb107-16"><a href="spatial-point-pattern-analysis.html#cb107-16"></a>neighbors &lt;-<span class="st"> </span>mins_cluster</span>
<span id="cb107-17"><a href="spatial-point-pattern-analysis.html#cb107-17"></a><span class="kw">points</span>(randompoints, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>, <span class="dt">pch=</span><span class="dv">4</span>)</span>
<span id="cb107-18"><a href="spatial-point-pattern-analysis.html#cb107-18"></a><span class="kw">points</span>(xy_cluster[mins_cluster, ], <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb107-19"><a href="spatial-point-pattern-analysis.html#cb107-19"></a><span class="co"># drawing the lines, easiest via a loop</span></span>
<span id="cb107-20"><a href="spatial-point-pattern-analysis.html#cb107-20"></a><span class="cf">for</span> (i <span class="cf">in</span> far25) {</span>
<span id="cb107-21"><a href="spatial-point-pattern-analysis.html#cb107-21"></a>  <span class="kw">lines</span>(<span class="kw">rbind</span>(xy_cluster[mins_cluster[i], ], randompoints[i, ]), <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb107-22"><a href="spatial-point-pattern-analysis.html#cb107-22"></a>}</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
</div>
<div id="regular-pattern-1" class="section level4">
<h4><span class="header-section-number">2.7.2.3</span> Regular Pattern</h4>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="spatial-point-pattern-analysis.html#cb108-1"></a>p2e_distances_regular =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb108-2"><a href="spatial-point-pattern-analysis.html#cb108-2"></a>p2e_mins_regular =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb108-3"><a href="spatial-point-pattern-analysis.html#cb108-3"></a>xy_regular =<span class="st"> </span><span class="kw">cbind</span>(pp_regular<span class="op">$</span>x, pp_regular<span class="op">$</span>y)</span>
<span id="cb108-4"><a href="spatial-point-pattern-analysis.html#cb108-4"></a></span>
<span id="cb108-5"><a href="spatial-point-pattern-analysis.html#cb108-5"></a></span>
<span id="cb108-6"><a href="spatial-point-pattern-analysis.html#cb108-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(randompoints)[<span class="dv">1</span>]){</span>
<span id="cb108-7"><a href="spatial-point-pattern-analysis.html#cb108-7"></a>dist1 =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">pairdist</span>(<span class="kw">rbind</span>(randompoints[i,],xy_regular)),<span class="dv">41</span>)</span>
<span id="cb108-8"><a href="spatial-point-pattern-analysis.html#cb108-8"></a></span>
<span id="cb108-9"><a href="spatial-point-pattern-analysis.html#cb108-9"></a>p2e_distances_regular =<span class="st"> </span><span class="kw">c</span>(p2e_distances_regular,<span class="kw">min</span>(dist1[<span class="dv">2</span><span class="op">:</span><span class="dv">41</span>,<span class="dv">1</span>]))</span>
<span id="cb108-10"><a href="spatial-point-pattern-analysis.html#cb108-10"></a>p2e_mins_regular =<span class="st"> </span><span class="kw">c</span>(p2e_mins_regular,<span class="kw">which.min</span>(dist1[<span class="dv">2</span><span class="op">:</span><span class="dv">41</span>,<span class="dv">1</span>]))</span>
<span id="cb108-11"><a href="spatial-point-pattern-analysis.html#cb108-11"></a>}</span>
<span id="cb108-12"><a href="spatial-point-pattern-analysis.html#cb108-12"></a></span>
<span id="cb108-13"><a href="spatial-point-pattern-analysis.html#cb108-13"></a></span>
<span id="cb108-14"><a href="spatial-point-pattern-analysis.html#cb108-14"></a><span class="kw">plot</span>(pp_regular)</span>
<span id="cb108-15"><a href="spatial-point-pattern-analysis.html#cb108-15"></a>ord &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">order</span>(p2e_distances_regular))</span>
<span id="cb108-16"><a href="spatial-point-pattern-analysis.html#cb108-16"></a>far25 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(randompoints)[<span class="dv">1</span>]</span>
<span id="cb108-17"><a href="spatial-point-pattern-analysis.html#cb108-17"></a>neighbors &lt;-<span class="st"> </span>p2e_mins_regular</span>
<span id="cb108-18"><a href="spatial-point-pattern-analysis.html#cb108-18"></a><span class="kw">points</span>(randompoints, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>, <span class="dt">pch=</span><span class="dv">4</span>)</span>
<span id="cb108-19"><a href="spatial-point-pattern-analysis.html#cb108-19"></a><span class="kw">points</span>(xy_regular[p2e_mins_regular, ], <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>, <span class="dt">pch=</span><span class="dv">20</span>)</span>
<span id="cb108-20"><a href="spatial-point-pattern-analysis.html#cb108-20"></a><span class="co"># drawing the lines, easiest via a loop</span></span>
<span id="cb108-21"><a href="spatial-point-pattern-analysis.html#cb108-21"></a><span class="cf">for</span> (i <span class="cf">in</span> far25) {</span>
<span id="cb108-22"><a href="spatial-point-pattern-analysis.html#cb108-22"></a>  <span class="kw">lines</span>(<span class="kw">rbind</span>(xy_regular[p2e_mins_regular[i], ], randompoints[i, ]), <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb108-23"><a href="spatial-point-pattern-analysis.html#cb108-23"></a>}</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
</div>
</div>
<div id="clark-and-evans-index-and-test" class="section level3">
<h3><span class="header-section-number">2.7.3</span> Clark and Evans Index and Test</h3>
<div id="csr-pattern-2" class="section level4">
<h4><span class="header-section-number">2.7.3.1</span> CSR Pattern</h4>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="spatial-point-pattern-analysis.html#cb109-1"></a><span class="kw">clarkevans</span>(pp_csr)</span></code></pre></div>
<pre><code>##     naive  Donnelly       cdf 
## 1.0135515 0.9443703 0.9719128</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="spatial-point-pattern-analysis.html#cb111-1"></a><span class="kw">clarkevans.test</span>(pp_csr)</span></code></pre></div>
<pre><code>## 
## 	Clark-Evans test
## 	No edge correction
## 	Z-test
## 
## data:  pp_csr
## R = 1.0136, p-value = 0.8698
## alternative hypothesis: two-sided</code></pre>
</div>
<div id="cluster-pattern-2" class="section level4">
<h4><span class="header-section-number">2.7.3.2</span> Cluster Pattern</h4>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="spatial-point-pattern-analysis.html#cb113-1"></a><span class="kw">clarkevans</span>(pp_cluster)</span></code></pre></div>
<pre><code>##     naive  Donnelly       cdf 
## 0.5852722 0.5453237 0.5621148</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="spatial-point-pattern-analysis.html#cb115-1"></a><span class="kw">clarkevans.test</span>(pp_cluster)</span></code></pre></div>
<pre><code>## 
## 	Clark-Evans test
## 	No edge correction
## 	Z-test
## 
## data:  pp_cluster
## R = 0.58527, p-value = 5.224e-07
## alternative hypothesis: two-sided</code></pre>
</div>
<div id="regular-pattern-2" class="section level4">
<h4><span class="header-section-number">2.7.3.3</span> Regular Pattern</h4>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="spatial-point-pattern-analysis.html#cb117-1"></a><span class="kw">clarkevans</span>(pp_regular)</span></code></pre></div>
<pre><code>##    naive Donnelly      cdf 
## 1.405457 1.309526 1.398362</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="spatial-point-pattern-analysis.html#cb119-1"></a><span class="kw">clarkevans.test</span>(pp_regular)</span></code></pre></div>
<pre><code>## 
## 	Clark-Evans test
## 	No edge correction
## 	Z-test
## 
## data:  pp_regular
## R = 1.4055, p-value = 9.309e-07
## alternative hypothesis: two-sided</code></pre>
</div>
</div>
</div>
<div id="g-function" class="section level2">
<h2><span class="header-section-number">2.8</span> G Function</h2>
<div id="simulated-csr-pattern-2" class="section level3">
<h3><span class="header-section-number">2.8.1</span> Simulated CSR Pattern</h3>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="spatial-point-pattern-analysis.html#cb121-1"></a>dmin_csr =<span class="st"> </span><span class="kw">nndist</span>(pp_csr)</span>
<span id="cb121-2"><a href="spatial-point-pattern-analysis.html#cb121-2"></a>distance_csr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">sort</span>(<span class="kw">unique</span>(dmin_csr)))</span>
<span id="cb121-3"><a href="spatial-point-pattern-analysis.html#cb121-3"></a><span class="co"># compute how many cases there with distances smaller that each x</span></span>
<span id="cb121-4"><a href="spatial-point-pattern-analysis.html#cb121-4"></a>Gd &lt;-<span class="st"> </span><span class="kw">sapply</span>(distance_csr, <span class="cf">function</span>(x) <span class="kw">sum</span>(dmin_csr <span class="op">&lt;</span><span class="st"> </span>x))</span>
<span id="cb121-5"><a href="spatial-point-pattern-analysis.html#cb121-5"></a><span class="co"># normalize to get values between 0 and 1</span></span>
<span id="cb121-6"><a href="spatial-point-pattern-analysis.html#cb121-6"></a>Gd &lt;-<span class="st"> </span>Gd <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(dmin_csr)</span>
<span id="cb121-7"><a href="spatial-point-pattern-analysis.html#cb121-7"></a><span class="kw">plot</span>(distance_csr, Gd, <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="spatial-point-pattern-analysis.html#cb122-1"></a><span class="kw">plot</span>(<span class="kw">Gest</span>(pp_csr))</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-52-2.png" width="672" /></p>
</div>
<div id="simulated-regular-pattern-2" class="section level3">
<h3><span class="header-section-number">2.8.2</span> Simulated Regular Pattern</h3>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="spatial-point-pattern-analysis.html#cb123-1"></a>dmin_regular =<span class="st"> </span><span class="kw">nndist</span>(pp_regular)</span>
<span id="cb123-2"><a href="spatial-point-pattern-analysis.html#cb123-2"></a>distance_regular &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="kw">sort</span>(<span class="kw">unique</span>(dmin_regular)))</span>
<span id="cb123-3"><a href="spatial-point-pattern-analysis.html#cb123-3"></a><span class="co"># compute how many cases there with distances smaller that each x</span></span>
<span id="cb123-4"><a href="spatial-point-pattern-analysis.html#cb123-4"></a>Gd &lt;-<span class="st"> </span><span class="kw">sapply</span>(distance_regular, <span class="cf">function</span>(x) <span class="kw">sum</span>(dmin_regular <span class="op">&lt;</span><span class="st"> </span>x))</span>
<span id="cb123-5"><a href="spatial-point-pattern-analysis.html#cb123-5"></a><span class="co"># normalize to get values between 0 and 1</span></span>
<span id="cb123-6"><a href="spatial-point-pattern-analysis.html#cb123-6"></a>Gd &lt;-<span class="st"> </span>Gd <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(dmin_regular)</span>
<span id="cb123-7"><a href="spatial-point-pattern-analysis.html#cb123-7"></a><span class="kw">plot</span>(distance_regular, Gd, <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="spatial-point-pattern-analysis.html#cb124-1"></a><span class="kw">plot</span>(<span class="kw">Gest</span>(pp_regular))</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-53-2.png" width="672" /></p>
</div>
<div id="simulated-cluster-pattern-2" class="section level3">
<h3><span class="header-section-number">2.8.3</span> Simulated Cluster Pattern</h3>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="spatial-point-pattern-analysis.html#cb125-1"></a>dmin_cluster =<span class="st"> </span><span class="kw">nndist</span>(pp_cluster)</span>
<span id="cb125-2"><a href="spatial-point-pattern-analysis.html#cb125-2"></a><span class="co"># get the unique distances (for the x-axis)</span></span>
<span id="cb125-3"><a href="spatial-point-pattern-analysis.html#cb125-3"></a>distance_cluster &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">round</span>(dmin_cluster,<span class="dv">2</span>)))</span>
<span id="cb125-4"><a href="spatial-point-pattern-analysis.html#cb125-4"></a><span class="co"># compute how many cases there with distances smaller that each x</span></span>
<span id="cb125-5"><a href="spatial-point-pattern-analysis.html#cb125-5"></a>Gd &lt;-<span class="st"> </span><span class="kw">sapply</span>(distance_cluster, <span class="cf">function</span>(x) <span class="kw">sum</span>(dmin_cluster <span class="op">&lt;</span><span class="st"> </span>x))</span>
<span id="cb125-6"><a href="spatial-point-pattern-analysis.html#cb125-6"></a><span class="co"># normalize to get values between 0 and 1</span></span>
<span id="cb125-7"><a href="spatial-point-pattern-analysis.html#cb125-7"></a>Gd &lt;-<span class="st"> </span>Gd <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(dmin_cluster)</span>
<span id="cb125-8"><a href="spatial-point-pattern-analysis.html#cb125-8"></a><span class="kw">plot</span>(distance_cluster, Gd, <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="spatial-point-pattern-analysis.html#cb126-1"></a><span class="kw">plot</span>(<span class="kw">Gest</span>(pp_cluster))</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-54-2.png" width="672" /></p>
</div>
</div>
<div id="f-function" class="section level2">
<h2><span class="header-section-number">2.9</span> F Function</h2>
<div id="simulated-csr-pattern-3" class="section level3">
<h3><span class="header-section-number">2.9.1</span> Simulated CSR Pattern</h3>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="spatial-point-pattern-analysis.html#cb127-1"></a><span class="kw">max</span>(p2e_distances_csr)</span></code></pre></div>
<pre><code>## [1] 0.1698011</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="spatial-point-pattern-analysis.html#cb129-1"></a><span class="co">## [1] 1829.738</span></span>
<span id="cb129-2"><a href="spatial-point-pattern-analysis.html#cb129-2"></a><span class="co"># get the unique distances (for the x-axis)</span></span>
<span id="cb129-3"><a href="spatial-point-pattern-analysis.html#cb129-3"></a>distance_csr &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">round</span>(p2e_distances_csr,<span class="dv">3</span>)))</span>
<span id="cb129-4"><a href="spatial-point-pattern-analysis.html#cb129-4"></a><span class="co"># compute how many cases there with distances smaller that each x</span></span>
<span id="cb129-5"><a href="spatial-point-pattern-analysis.html#cb129-5"></a>Fd &lt;-<span class="st"> </span><span class="kw">sapply</span>(distance_csr, <span class="cf">function</span>(x) <span class="kw">sum</span>(p2e_distances_csr <span class="op">&lt;</span><span class="st"> </span>x))</span>
<span id="cb129-6"><a href="spatial-point-pattern-analysis.html#cb129-6"></a><span class="co"># normalize to get values between 0 and 1</span></span>
<span id="cb129-7"><a href="spatial-point-pattern-analysis.html#cb129-7"></a>Fd &lt;-<span class="st"> </span>Fd <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(p2e_distances_csr)</span>
<span id="cb129-8"><a href="spatial-point-pattern-analysis.html#cb129-8"></a><span class="kw">plot</span>(distance_csr, Fd, <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="spatial-point-pattern-analysis.html#cb130-1"></a><span class="kw">plot</span>(<span class="kw">Fest</span>(pp_csr))</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-55-2.png" width="672" /></p>
</div>
<div id="simulated-regular-pattern-3" class="section level3">
<h3><span class="header-section-number">2.9.2</span> Simulated Regular Pattern</h3>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="spatial-point-pattern-analysis.html#cb131-1"></a><span class="kw">max</span>(p2e_distances_regular)</span></code></pre></div>
<pre><code>## [1] 0.1694105</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="spatial-point-pattern-analysis.html#cb133-1"></a><span class="co">## [1] 1829.738</span></span>
<span id="cb133-2"><a href="spatial-point-pattern-analysis.html#cb133-2"></a><span class="co"># get the unique distances (for the x-axis)</span></span>
<span id="cb133-3"><a href="spatial-point-pattern-analysis.html#cb133-3"></a>distance_regular &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">round</span>(p2e_distances_regular,<span class="dv">3</span>)))</span>
<span id="cb133-4"><a href="spatial-point-pattern-analysis.html#cb133-4"></a><span class="co"># compute how many cases there with distances smaller that each x</span></span>
<span id="cb133-5"><a href="spatial-point-pattern-analysis.html#cb133-5"></a>Fd &lt;-<span class="st"> </span><span class="kw">sapply</span>(distance_regular, <span class="cf">function</span>(x) <span class="kw">sum</span>(p2e_distances_regular <span class="op">&lt;</span><span class="st"> </span>x))</span>
<span id="cb133-6"><a href="spatial-point-pattern-analysis.html#cb133-6"></a><span class="co"># normalize to get values between 0 and 1</span></span>
<span id="cb133-7"><a href="spatial-point-pattern-analysis.html#cb133-7"></a>Fd &lt;-<span class="st"> </span>Fd <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(p2e_distances_regular)</span>
<span id="cb133-8"><a href="spatial-point-pattern-analysis.html#cb133-8"></a><span class="kw">plot</span>(distance_regular, Fd, <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="spatial-point-pattern-analysis.html#cb134-1"></a><span class="kw">plot</span>(<span class="kw">Fest</span>(pp_regular))</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-56-2.png" width="672" /></p>
</div>
<div id="simulated-cluster-pattern-3" class="section level3">
<h3><span class="header-section-number">2.9.3</span> Simulated Cluster Pattern</h3>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="spatial-point-pattern-analysis.html#cb135-1"></a><span class="kw">max</span>(p2e_distances_cluster)</span></code></pre></div>
<pre><code>## [1] 0.3557434</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="spatial-point-pattern-analysis.html#cb137-1"></a><span class="co">## [1] 1829.738</span></span>
<span id="cb137-2"><a href="spatial-point-pattern-analysis.html#cb137-2"></a><span class="co"># get the unique distances (for the x-axis)</span></span>
<span id="cb137-3"><a href="spatial-point-pattern-analysis.html#cb137-3"></a>distance_cluster &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">round</span>(p2e_distances_cluster,<span class="dv">3</span>)))</span>
<span id="cb137-4"><a href="spatial-point-pattern-analysis.html#cb137-4"></a><span class="co"># compute how many cases there with distances smaller that each x</span></span>
<span id="cb137-5"><a href="spatial-point-pattern-analysis.html#cb137-5"></a>Fd &lt;-<span class="st"> </span><span class="kw">sapply</span>(distance_cluster, <span class="cf">function</span>(x) <span class="kw">sum</span>(p2e_distances_cluster <span class="op">&lt;</span><span class="st"> </span>x))</span>
<span id="cb137-6"><a href="spatial-point-pattern-analysis.html#cb137-6"></a><span class="co"># normalize to get values between 0 and 1</span></span>
<span id="cb137-7"><a href="spatial-point-pattern-analysis.html#cb137-7"></a>Fd &lt;-<span class="st"> </span>Fd <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(p2e_distances_cluster)</span>
<span id="cb137-8"><a href="spatial-point-pattern-analysis.html#cb137-8"></a><span class="kw">plot</span>(distance_cluster, Fd, <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>)</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="spatial-point-pattern-analysis.html#cb138-1"></a><span class="kw">plot</span>(<span class="kw">Fest</span>(pp_cluster))</span></code></pre></div>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-57-2.png" width="672" /></p>
</div>
</div>
<div id="ripleys-k-function" class="section level2">
<h2><span class="header-section-number">2.10</span> Ripley’s K Function</h2>
<div id="simulated-csr-pattern-4" class="section level3">
<h3><span class="header-section-number">2.10.1</span> Simulated CSR Pattern</h3>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="spatial-point-pattern-analysis.html#cb139-1"></a>K &lt;-<span class="st"> </span><span class="kw">Kest</span>(pp_csr)</span>
<span id="cb139-2"><a href="spatial-point-pattern-analysis.html#cb139-2"></a><span class="kw">plot</span>(K, <span class="dt">main=</span><span class="ot">NULL</span>, <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">legendargs=</span><span class="kw">list</span>(<span class="dt">cex=</span><span class="fl">0.8</span>, <span class="dt">xpd=</span><span class="ot">TRUE</span>, <span class="dt">inset=</span><span class="kw">c</span>(<span class="fl">1.01</span>, <span class="dv">0</span>) ))</span></code></pre></div>
<pre><code>## Warning in min(D[scaledlegbox]): no non-missing arguments to min; returning Inf</code></pre>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
</div>
<div id="simulated-regular-pattern-4" class="section level3">
<h3><span class="header-section-number">2.10.2</span> Simulated Regular Pattern</h3>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="spatial-point-pattern-analysis.html#cb141-1"></a>K &lt;-<span class="st"> </span><span class="kw">Kest</span>(pp_regular)</span>
<span id="cb141-2"><a href="spatial-point-pattern-analysis.html#cb141-2"></a><span class="kw">plot</span>(K, <span class="dt">main=</span><span class="ot">NULL</span>, <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">legendargs=</span><span class="kw">list</span>(<span class="dt">cex=</span><span class="fl">0.8</span>, <span class="dt">xpd=</span><span class="ot">TRUE</span>, <span class="dt">inset=</span><span class="kw">c</span>(<span class="fl">1.01</span>, <span class="dv">0</span>) ))</span></code></pre></div>
<pre><code>## Warning in min(D[scaledlegbox]): no non-missing arguments to min; returning Inf</code></pre>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
</div>
<div id="simulated-cluster-pattern-4" class="section level3">
<h3><span class="header-section-number">2.10.3</span> Simulated Cluster Pattern</h3>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="spatial-point-pattern-analysis.html#cb143-1"></a>K &lt;-<span class="st"> </span><span class="kw">Kest</span>(pp_cluster)</span>
<span id="cb143-2"><a href="spatial-point-pattern-analysis.html#cb143-2"></a><span class="kw">plot</span>(K, <span class="dt">main=</span><span class="ot">NULL</span>, <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">legendargs=</span><span class="kw">list</span>(<span class="dt">cex=</span><span class="fl">0.8</span>, <span class="dt">xpd=</span><span class="ot">TRUE</span>, <span class="dt">inset=</span><span class="kw">c</span>(<span class="fl">1.01</span>, <span class="dv">0</span>) ))</span></code></pre></div>
<pre><code>## Warning in min(D[scaledlegbox]): no non-missing arguments to min; returning Inf</code></pre>
<p><img src="Applied-Spatial-Data-Analysis_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
</div>
</div>
<div id="references" class="section level2">
<h2><span class="header-section-number">2.11</span> References:</h2>
<ul>
<li><a href="http://www.rdatamining.com/examples/association-rules">R and Data Mining</a></li>
<li><a href="https://github.com/susanli2016/Data-Analysis-with-R/blob/master/Market_Basket_Analysis.Rmd">Susan Li - MBA</a></li>
<li><a href="https://www.datacamp.com/community/tutorials/market-basket-analysis-r">Datacamp</a></li>
<li>Dr Juwa Nyirenda’s lecture notes</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatial-lattice-data-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/point.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Applied Spatial Data Analysis.pdf", "Applied Spatial Data Analysis.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
